{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pyspark import SparkConf, SparkContext"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "conf = SparkConf().setMaster(\"local\").setAppName(\"Similarity\")\n",
    "sc = SparkContext(conf=conf)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 讀取文件"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "t_all = sc.wholeTextFiles(\"C:\\\\Users\\\\admin\\\\athletics\\\\*\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('file:/C:/Users/admin/athletics/001.txt',\n",
       "  'Claxton hunting first major medal\\n\\nBritish hurdler Sarah Claxton is confident she can win her first major medal at next month\\'s European Indoor Championships in Madrid.\\n\\nThe 25-year-old has already smashed the British record over 60m hurdles twice this season, setting a new mark of 7.96 seconds to win the AAAs title. \"I am quite confident,\" said Claxton. \"But I take each race as it comes. \"As long as I keep up my training but not do too much I think there is a chance of a medal.\" Claxton has won the national 60m hurdles title for the past three years but has struggled to translate her domestic success to the international stage. Now, the Scotland-born athlete owns the equal fifth-fastest time in the world this year. And at last week\\'s Birmingham Grand Prix, Claxton left European medal favourite Russian Irina Shevchenko trailing in sixth spot.\\n\\nFor the first time, Claxton has only been preparing for a campaign over the hurdles - which could explain her leap in form. In previous seasons, the 25-year-old also contested the long jump but since moving from Colchester to London she has re-focused her attentions. Claxton will see if her new training regime pays dividends at the European Indoors which take place on 5-6 March.\\n')]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "t_all.take(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 一、將Docments轉為Shingles"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.去除標點符號、空格"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "metadata": {},
   "outputs": [],
   "source": [
    "topics = t_all.map(lambda x: (x[0][-7:-4],x[1].translate(str.maketrans(\"\\n\",\" \",string.punctuation)).strip().replace(\"  \",\" \")))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "import string"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('001',\n",
       "  'Claxton hunting first major medal British hurdler Sarah Claxton is confident she can win her first major medal at next months European Indoor Championships in Madrid The 25yearold has already smashed the British record over 60m hurdles twice this season setting a new mark of 796 seconds to win the AAAs title I am quite confident said Claxton But I take each race as it comes As long as I keep up my training but not do too much I think there is a chance of a medal Claxton has won the national 60m hurdles title for the past three years but has struggled to translate her domestic success to the international stage Now the Scotlandborn athlete owns the equal fifthfastest time in the world this year And at last weeks Birmingham Grand Prix Claxton left European medal favourite Russian Irina Shevchenko trailing in sixth spot For the first time Claxton has only been preparing for a campaign over the hurdles which could explain her leap in form In previous seasons the 25yearold also contested the long jump but since moving from Colchester to London she has refocused her attentions Claxton will see if her new training regime pays dividends at the European Indoors which take place on 56 March')]"
      ]
     },
     "execution_count": 158,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "topics.take(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2.把每個文件中字分開以便後續製作3-shingles"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "metadata": {},
   "outputs": [],
   "source": [
    "topic_split = topics.map(lambda x: (x[0],x[1].split(\" \")))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('001',\n",
       "  ['Claxton',\n",
       "   'hunting',\n",
       "   'first',\n",
       "   'major',\n",
       "   'medal',\n",
       "   'British',\n",
       "   'hurdler',\n",
       "   'Sarah',\n",
       "   'Claxton',\n",
       "   'is',\n",
       "   'confident',\n",
       "   'she',\n",
       "   'can',\n",
       "   'win',\n",
       "   'her',\n",
       "   'first',\n",
       "   'major',\n",
       "   'medal',\n",
       "   'at',\n",
       "   'next',\n",
       "   'months',\n",
       "   'European',\n",
       "   'Indoor',\n",
       "   'Championships',\n",
       "   'in',\n",
       "   'Madrid',\n",
       "   'The',\n",
       "   '25yearold',\n",
       "   'has',\n",
       "   'already',\n",
       "   'smashed',\n",
       "   'the',\n",
       "   'British',\n",
       "   'record',\n",
       "   'over',\n",
       "   '60m',\n",
       "   'hurdles',\n",
       "   'twice',\n",
       "   'this',\n",
       "   'season',\n",
       "   'setting',\n",
       "   'a',\n",
       "   'new',\n",
       "   'mark',\n",
       "   'of',\n",
       "   '796',\n",
       "   'seconds',\n",
       "   'to',\n",
       "   'win',\n",
       "   'the',\n",
       "   'AAAs',\n",
       "   'title',\n",
       "   'I',\n",
       "   'am',\n",
       "   'quite',\n",
       "   'confident',\n",
       "   'said',\n",
       "   'Claxton',\n",
       "   'But',\n",
       "   'I',\n",
       "   'take',\n",
       "   'each',\n",
       "   'race',\n",
       "   'as',\n",
       "   'it',\n",
       "   'comes',\n",
       "   'As',\n",
       "   'long',\n",
       "   'as',\n",
       "   'I',\n",
       "   'keep',\n",
       "   'up',\n",
       "   'my',\n",
       "   'training',\n",
       "   'but',\n",
       "   'not',\n",
       "   'do',\n",
       "   'too',\n",
       "   'much',\n",
       "   'I',\n",
       "   'think',\n",
       "   'there',\n",
       "   'is',\n",
       "   'a',\n",
       "   'chance',\n",
       "   'of',\n",
       "   'a',\n",
       "   'medal',\n",
       "   'Claxton',\n",
       "   'has',\n",
       "   'won',\n",
       "   'the',\n",
       "   'national',\n",
       "   '60m',\n",
       "   'hurdles',\n",
       "   'title',\n",
       "   'for',\n",
       "   'the',\n",
       "   'past',\n",
       "   'three',\n",
       "   'years',\n",
       "   'but',\n",
       "   'has',\n",
       "   'struggled',\n",
       "   'to',\n",
       "   'translate',\n",
       "   'her',\n",
       "   'domestic',\n",
       "   'success',\n",
       "   'to',\n",
       "   'the',\n",
       "   'international',\n",
       "   'stage',\n",
       "   'Now',\n",
       "   'the',\n",
       "   'Scotlandborn',\n",
       "   'athlete',\n",
       "   'owns',\n",
       "   'the',\n",
       "   'equal',\n",
       "   'fifthfastest',\n",
       "   'time',\n",
       "   'in',\n",
       "   'the',\n",
       "   'world',\n",
       "   'this',\n",
       "   'year',\n",
       "   'And',\n",
       "   'at',\n",
       "   'last',\n",
       "   'weeks',\n",
       "   'Birmingham',\n",
       "   'Grand',\n",
       "   'Prix',\n",
       "   'Claxton',\n",
       "   'left',\n",
       "   'European',\n",
       "   'medal',\n",
       "   'favourite',\n",
       "   'Russian',\n",
       "   'Irina',\n",
       "   'Shevchenko',\n",
       "   'trailing',\n",
       "   'in',\n",
       "   'sixth',\n",
       "   'spot',\n",
       "   'For',\n",
       "   'the',\n",
       "   'first',\n",
       "   'time',\n",
       "   'Claxton',\n",
       "   'has',\n",
       "   'only',\n",
       "   'been',\n",
       "   'preparing',\n",
       "   'for',\n",
       "   'a',\n",
       "   'campaign',\n",
       "   'over',\n",
       "   'the',\n",
       "   'hurdles',\n",
       "   'which',\n",
       "   'could',\n",
       "   'explain',\n",
       "   'her',\n",
       "   'leap',\n",
       "   'in',\n",
       "   'form',\n",
       "   'In',\n",
       "   'previous',\n",
       "   'seasons',\n",
       "   'the',\n",
       "   '25yearold',\n",
       "   'also',\n",
       "   'contested',\n",
       "   'the',\n",
       "   'long',\n",
       "   'jump',\n",
       "   'but',\n",
       "   'since',\n",
       "   'moving',\n",
       "   'from',\n",
       "   'Colchester',\n",
       "   'to',\n",
       "   'London',\n",
       "   'she',\n",
       "   'has',\n",
       "   'refocused',\n",
       "   'her',\n",
       "   'attentions',\n",
       "   'Claxton',\n",
       "   'will',\n",
       "   'see',\n",
       "   'if',\n",
       "   'her',\n",
       "   'new',\n",
       "   'training',\n",
       "   'regime',\n",
       "   'pays',\n",
       "   'dividends',\n",
       "   'at',\n",
       "   'the',\n",
       "   'European',\n",
       "   'Indoors',\n",
       "   'which',\n",
       "   'take',\n",
       "   'place',\n",
       "   'on',\n",
       "   '56',\n",
       "   'March'])]"
      ]
     },
     "execution_count": 160,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "topic_split.take(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3. 建立一個shingle set"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "sh_set = []"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 每三個字為單位，每次向後一個字，append到shingle set\n",
    "for c in topic_split.collect()[1]:\n",
    "    for i in range(0,len(c)-2):\n",
    "        sh_set.append(c[i:i+3])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 4.讓每個文件跟shingle set作比對"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "metadata": {},
   "outputs": [],
   "source": [
    "#製作出每個文件自己部分的shingle\n",
    "def self_set(x):\n",
    "    splited = x[1].split(\" \")\n",
    "    self_set = []\n",
    "    for i in range(0,len(splited)-2):\n",
    "        self_set.append(splited[i:i+3])\n",
    "    return (x[0],self_set)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 164,
   "metadata": {},
   "outputs": [],
   "source": [
    "topics_self = topics.map(self_set)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 165,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('001',\n",
       "  [['Claxton', 'hunting', 'first'],\n",
       "   ['hunting', 'first', 'major'],\n",
       "   ['first', 'major', 'medal'],\n",
       "   ['major', 'medal', 'British'],\n",
       "   ['medal', 'British', 'hurdler'],\n",
       "   ['British', 'hurdler', 'Sarah'],\n",
       "   ['hurdler', 'Sarah', 'Claxton'],\n",
       "   ['Sarah', 'Claxton', 'is'],\n",
       "   ['Claxton', 'is', 'confident'],\n",
       "   ['is', 'confident', 'she'],\n",
       "   ['confident', 'she', 'can'],\n",
       "   ['she', 'can', 'win'],\n",
       "   ['can', 'win', 'her'],\n",
       "   ['win', 'her', 'first'],\n",
       "   ['her', 'first', 'major'],\n",
       "   ['first', 'major', 'medal'],\n",
       "   ['major', 'medal', 'at'],\n",
       "   ['medal', 'at', 'next'],\n",
       "   ['at', 'next', 'months'],\n",
       "   ['next', 'months', 'European'],\n",
       "   ['months', 'European', 'Indoor'],\n",
       "   ['European', 'Indoor', 'Championships'],\n",
       "   ['Indoor', 'Championships', 'in'],\n",
       "   ['Championships', 'in', 'Madrid'],\n",
       "   ['in', 'Madrid', 'The'],\n",
       "   ['Madrid', 'The', '25yearold'],\n",
       "   ['The', '25yearold', 'has'],\n",
       "   ['25yearold', 'has', 'already'],\n",
       "   ['has', 'already', 'smashed'],\n",
       "   ['already', 'smashed', 'the'],\n",
       "   ['smashed', 'the', 'British'],\n",
       "   ['the', 'British', 'record'],\n",
       "   ['British', 'record', 'over'],\n",
       "   ['record', 'over', '60m'],\n",
       "   ['over', '60m', 'hurdles'],\n",
       "   ['60m', 'hurdles', 'twice'],\n",
       "   ['hurdles', 'twice', 'this'],\n",
       "   ['twice', 'this', 'season'],\n",
       "   ['this', 'season', 'setting'],\n",
       "   ['season', 'setting', 'a'],\n",
       "   ['setting', 'a', 'new'],\n",
       "   ['a', 'new', 'mark'],\n",
       "   ['new', 'mark', 'of'],\n",
       "   ['mark', 'of', '796'],\n",
       "   ['of', '796', 'seconds'],\n",
       "   ['796', 'seconds', 'to'],\n",
       "   ['seconds', 'to', 'win'],\n",
       "   ['to', 'win', 'the'],\n",
       "   ['win', 'the', 'AAAs'],\n",
       "   ['the', 'AAAs', 'title'],\n",
       "   ['AAAs', 'title', 'I'],\n",
       "   ['title', 'I', 'am'],\n",
       "   ['I', 'am', 'quite'],\n",
       "   ['am', 'quite', 'confident'],\n",
       "   ['quite', 'confident', 'said'],\n",
       "   ['confident', 'said', 'Claxton'],\n",
       "   ['said', 'Claxton', 'But'],\n",
       "   ['Claxton', 'But', 'I'],\n",
       "   ['But', 'I', 'take'],\n",
       "   ['I', 'take', 'each'],\n",
       "   ['take', 'each', 'race'],\n",
       "   ['each', 'race', 'as'],\n",
       "   ['race', 'as', 'it'],\n",
       "   ['as', 'it', 'comes'],\n",
       "   ['it', 'comes', 'As'],\n",
       "   ['comes', 'As', 'long'],\n",
       "   ['As', 'long', 'as'],\n",
       "   ['long', 'as', 'I'],\n",
       "   ['as', 'I', 'keep'],\n",
       "   ['I', 'keep', 'up'],\n",
       "   ['keep', 'up', 'my'],\n",
       "   ['up', 'my', 'training'],\n",
       "   ['my', 'training', 'but'],\n",
       "   ['training', 'but', 'not'],\n",
       "   ['but', 'not', 'do'],\n",
       "   ['not', 'do', 'too'],\n",
       "   ['do', 'too', 'much'],\n",
       "   ['too', 'much', 'I'],\n",
       "   ['much', 'I', 'think'],\n",
       "   ['I', 'think', 'there'],\n",
       "   ['think', 'there', 'is'],\n",
       "   ['there', 'is', 'a'],\n",
       "   ['is', 'a', 'chance'],\n",
       "   ['a', 'chance', 'of'],\n",
       "   ['chance', 'of', 'a'],\n",
       "   ['of', 'a', 'medal'],\n",
       "   ['a', 'medal', 'Claxton'],\n",
       "   ['medal', 'Claxton', 'has'],\n",
       "   ['Claxton', 'has', 'won'],\n",
       "   ['has', 'won', 'the'],\n",
       "   ['won', 'the', 'national'],\n",
       "   ['the', 'national', '60m'],\n",
       "   ['national', '60m', 'hurdles'],\n",
       "   ['60m', 'hurdles', 'title'],\n",
       "   ['hurdles', 'title', 'for'],\n",
       "   ['title', 'for', 'the'],\n",
       "   ['for', 'the', 'past'],\n",
       "   ['the', 'past', 'three'],\n",
       "   ['past', 'three', 'years'],\n",
       "   ['three', 'years', 'but'],\n",
       "   ['years', 'but', 'has'],\n",
       "   ['but', 'has', 'struggled'],\n",
       "   ['has', 'struggled', 'to'],\n",
       "   ['struggled', 'to', 'translate'],\n",
       "   ['to', 'translate', 'her'],\n",
       "   ['translate', 'her', 'domestic'],\n",
       "   ['her', 'domestic', 'success'],\n",
       "   ['domestic', 'success', 'to'],\n",
       "   ['success', 'to', 'the'],\n",
       "   ['to', 'the', 'international'],\n",
       "   ['the', 'international', 'stage'],\n",
       "   ['international', 'stage', 'Now'],\n",
       "   ['stage', 'Now', 'the'],\n",
       "   ['Now', 'the', 'Scotlandborn'],\n",
       "   ['the', 'Scotlandborn', 'athlete'],\n",
       "   ['Scotlandborn', 'athlete', 'owns'],\n",
       "   ['athlete', 'owns', 'the'],\n",
       "   ['owns', 'the', 'equal'],\n",
       "   ['the', 'equal', 'fifthfastest'],\n",
       "   ['equal', 'fifthfastest', 'time'],\n",
       "   ['fifthfastest', 'time', 'in'],\n",
       "   ['time', 'in', 'the'],\n",
       "   ['in', 'the', 'world'],\n",
       "   ['the', 'world', 'this'],\n",
       "   ['world', 'this', 'year'],\n",
       "   ['this', 'year', 'And'],\n",
       "   ['year', 'And', 'at'],\n",
       "   ['And', 'at', 'last'],\n",
       "   ['at', 'last', 'weeks'],\n",
       "   ['last', 'weeks', 'Birmingham'],\n",
       "   ['weeks', 'Birmingham', 'Grand'],\n",
       "   ['Birmingham', 'Grand', 'Prix'],\n",
       "   ['Grand', 'Prix', 'Claxton'],\n",
       "   ['Prix', 'Claxton', 'left'],\n",
       "   ['Claxton', 'left', 'European'],\n",
       "   ['left', 'European', 'medal'],\n",
       "   ['European', 'medal', 'favourite'],\n",
       "   ['medal', 'favourite', 'Russian'],\n",
       "   ['favourite', 'Russian', 'Irina'],\n",
       "   ['Russian', 'Irina', 'Shevchenko'],\n",
       "   ['Irina', 'Shevchenko', 'trailing'],\n",
       "   ['Shevchenko', 'trailing', 'in'],\n",
       "   ['trailing', 'in', 'sixth'],\n",
       "   ['in', 'sixth', 'spot'],\n",
       "   ['sixth', 'spot', 'For'],\n",
       "   ['spot', 'For', 'the'],\n",
       "   ['For', 'the', 'first'],\n",
       "   ['the', 'first', 'time'],\n",
       "   ['first', 'time', 'Claxton'],\n",
       "   ['time', 'Claxton', 'has'],\n",
       "   ['Claxton', 'has', 'only'],\n",
       "   ['has', 'only', 'been'],\n",
       "   ['only', 'been', 'preparing'],\n",
       "   ['been', 'preparing', 'for'],\n",
       "   ['preparing', 'for', 'a'],\n",
       "   ['for', 'a', 'campaign'],\n",
       "   ['a', 'campaign', 'over'],\n",
       "   ['campaign', 'over', 'the'],\n",
       "   ['over', 'the', 'hurdles'],\n",
       "   ['the', 'hurdles', 'which'],\n",
       "   ['hurdles', 'which', 'could'],\n",
       "   ['which', 'could', 'explain'],\n",
       "   ['could', 'explain', 'her'],\n",
       "   ['explain', 'her', 'leap'],\n",
       "   ['her', 'leap', 'in'],\n",
       "   ['leap', 'in', 'form'],\n",
       "   ['in', 'form', 'In'],\n",
       "   ['form', 'In', 'previous'],\n",
       "   ['In', 'previous', 'seasons'],\n",
       "   ['previous', 'seasons', 'the'],\n",
       "   ['seasons', 'the', '25yearold'],\n",
       "   ['the', '25yearold', 'also'],\n",
       "   ['25yearold', 'also', 'contested'],\n",
       "   ['also', 'contested', 'the'],\n",
       "   ['contested', 'the', 'long'],\n",
       "   ['the', 'long', 'jump'],\n",
       "   ['long', 'jump', 'but'],\n",
       "   ['jump', 'but', 'since'],\n",
       "   ['but', 'since', 'moving'],\n",
       "   ['since', 'moving', 'from'],\n",
       "   ['moving', 'from', 'Colchester'],\n",
       "   ['from', 'Colchester', 'to'],\n",
       "   ['Colchester', 'to', 'London'],\n",
       "   ['to', 'London', 'she'],\n",
       "   ['London', 'she', 'has'],\n",
       "   ['she', 'has', 'refocused'],\n",
       "   ['has', 'refocused', 'her'],\n",
       "   ['refocused', 'her', 'attentions'],\n",
       "   ['her', 'attentions', 'Claxton'],\n",
       "   ['attentions', 'Claxton', 'will'],\n",
       "   ['Claxton', 'will', 'see'],\n",
       "   ['will', 'see', 'if'],\n",
       "   ['see', 'if', 'her'],\n",
       "   ['if', 'her', 'new'],\n",
       "   ['her', 'new', 'training'],\n",
       "   ['new', 'training', 'regime'],\n",
       "   ['training', 'regime', 'pays'],\n",
       "   ['regime', 'pays', 'dividends'],\n",
       "   ['pays', 'dividends', 'at'],\n",
       "   ['dividends', 'at', 'the'],\n",
       "   ['at', 'the', 'European'],\n",
       "   ['the', 'European', 'Indoors'],\n",
       "   ['European', 'Indoors', 'which'],\n",
       "   ['Indoors', 'which', 'take'],\n",
       "   ['which', 'take', 'place'],\n",
       "   ['take', 'place', 'on'],\n",
       "   ['place', 'on', '56'],\n",
       "   ['on', '56', 'March']]),\n",
       " ('002',\n",
       "  [['OSullivan', 'could', 'run'],\n",
       "   ['could', 'run', 'in'],\n",
       "   ['run', 'in', 'Worlds'],\n",
       "   ['in', 'Worlds', 'Sonia'],\n",
       "   ['Worlds', 'Sonia', 'OSullivan'],\n",
       "   ['Sonia', 'OSullivan', 'has'],\n",
       "   ['OSullivan', 'has', 'indicated'],\n",
       "   ['has', 'indicated', 'that'],\n",
       "   ['indicated', 'that', 'she'],\n",
       "   ['that', 'she', 'would'],\n",
       "   ['she', 'would', 'like'],\n",
       "   ['would', 'like', 'to'],\n",
       "   ['like', 'to', 'participate'],\n",
       "   ['to', 'participate', 'in'],\n",
       "   ['participate', 'in', 'next'],\n",
       "   ['in', 'next', 'months'],\n",
       "   ['next', 'months', 'World'],\n",
       "   ['months', 'World', 'Cross'],\n",
       "   ['World', 'Cross', 'Country'],\n",
       "   ['Cross', 'Country', 'Championships'],\n",
       "   ['Country', 'Championships', 'in'],\n",
       "   ['Championships', 'in', 'St'],\n",
       "   ['in', 'St', 'Etienne'],\n",
       "   ['St', 'Etienne', 'Athletics'],\n",
       "   ['Etienne', 'Athletics', 'Ireland'],\n",
       "   ['Athletics', 'Ireland', 'have'],\n",
       "   ['Ireland', 'have', 'hinted'],\n",
       "   ['have', 'hinted', 'that'],\n",
       "   ['hinted', 'that', 'the'],\n",
       "   ['that', 'the', '35yearold'],\n",
       "   ['the', '35yearold', 'Cobh'],\n",
       "   ['35yearold', 'Cobh', 'runner'],\n",
       "   ['Cobh', 'runner', 'may'],\n",
       "   ['runner', 'may', 'be'],\n",
       "   ['may', 'be', 'included'],\n",
       "   ['be', 'included', 'in'],\n",
       "   ['included', 'in', 'the'],\n",
       "   ['in', 'the', 'official'],\n",
       "   ['the', 'official', 'lineup'],\n",
       "   ['official', 'lineup', 'for'],\n",
       "   ['lineup', 'for', 'the'],\n",
       "   ['for', 'the', 'event'],\n",
       "   ['the', 'event', 'in'],\n",
       "   ['event', 'in', 'France'],\n",
       "   ['in', 'France', 'on'],\n",
       "   ['France', 'on', '1920'],\n",
       "   ['on', '1920', 'March'],\n",
       "   ['1920', 'March', 'Provincial'],\n",
       "   ['March', 'Provincial', 'teams'],\n",
       "   ['Provincial', 'teams', 'were'],\n",
       "   ['teams', 'were', 'selected'],\n",
       "   ['were', 'selected', 'after'],\n",
       "   ['selected', 'after', 'last'],\n",
       "   ['after', 'last', 'Saturdays'],\n",
       "   ['last', 'Saturdays', 'Nationals'],\n",
       "   ['Saturdays', 'Nationals', 'in'],\n",
       "   ['Nationals', 'in', 'Santry'],\n",
       "   ['in', 'Santry', 'and'],\n",
       "   ['Santry', 'and', 'will'],\n",
       "   ['and', 'will', 'be'],\n",
       "   ['will', 'be', 'officially'],\n",
       "   ['be', 'officially', 'announced'],\n",
       "   ['officially', 'announced', 'this'],\n",
       "   ['announced', 'this', 'week'],\n",
       "   ['this', 'week', 'OSullivan'],\n",
       "   ['week', 'OSullivan', 'is'],\n",
       "   ['OSullivan', 'is', 'at'],\n",
       "   ['is', 'at', 'present'],\n",
       "   ['at', 'present', 'preparing'],\n",
       "   ['present', 'preparing', 'for'],\n",
       "   ['preparing', 'for', 'the'],\n",
       "   ['for', 'the', 'London'],\n",
       "   ['the', 'London', 'marathon'],\n",
       "   ['London', 'marathon', 'on'],\n",
       "   ['marathon', 'on', '17'],\n",
       "   ['on', '17', 'April'],\n",
       "   ['17', 'April', 'The'],\n",
       "   ['April', 'The', 'participation'],\n",
       "   ['The', 'participation', 'of'],\n",
       "   ['participation', 'of', 'OSullivan'],\n",
       "   ['of', 'OSullivan', 'currentily'],\n",
       "   ['OSullivan', 'currentily', 'training'],\n",
       "   ['currentily', 'training', 'at'],\n",
       "   ['training', 'at', 'her'],\n",
       "   ['at', 'her', 'base'],\n",
       "   ['her', 'base', 'in'],\n",
       "   ['base', 'in', 'Australia'],\n",
       "   ['in', 'Australia', 'would'],\n",
       "   ['Australia', 'would', 'boost'],\n",
       "   ['would', 'boost', 'the'],\n",
       "   ['boost', 'the', 'Ireland'],\n",
       "   ['the', 'Ireland', 'team'],\n",
       "   ['Ireland', 'team', 'who'],\n",
       "   ['team', 'who', 'won'],\n",
       "   ['who', 'won', 'the'],\n",
       "   ['won', 'the', 'bronze'],\n",
       "   ['the', 'bronze', 'three'],\n",
       "   ['bronze', 'three', 'years'],\n",
       "   ['three', 'years', 'agio'],\n",
       "   ['years', 'agio', 'The'],\n",
       "   ['agio', 'The', 'first'],\n",
       "   ['The', 'first', 'three'],\n",
       "   ['first', 'three', 'at'],\n",
       "   ['three', 'at', 'Santry'],\n",
       "   ['at', 'Santry', 'last'],\n",
       "   ['Santry', 'last', 'Saturday'],\n",
       "   ['last', 'Saturday', 'Jolene'],\n",
       "   ['Saturday', 'Jolene', 'Byrne'],\n",
       "   ['Jolene', 'Byrne', 'Maria'],\n",
       "   ['Byrne', 'Maria', 'McCambridge'],\n",
       "   ['Maria', 'McCambridge', 'and'],\n",
       "   ['McCambridge', 'and', 'Fionnualla'],\n",
       "   ['and', 'Fionnualla', 'Britton'],\n",
       "   ['Fionnualla', 'Britton', 'are'],\n",
       "   ['Britton', 'are', 'automatic'],\n",
       "   ['are', 'automatic', 'selections'],\n",
       "   ['automatic', 'selections', 'and'],\n",
       "   ['selections', 'and', 'will'],\n",
       "   ['and', 'will', 'most'],\n",
       "   ['will', 'most', 'likely'],\n",
       "   ['most', 'likely', 'form'],\n",
       "   ['likely', 'form', 'part'],\n",
       "   ['form', 'part', 'of'],\n",
       "   ['part', 'of', 'the'],\n",
       "   ['of', 'the', 'longcourse'],\n",
       "   ['the', 'longcourse', 'team'],\n",
       "   ['longcourse', 'team', 'OSullivan'],\n",
       "   ['team', 'OSullivan', 'will'],\n",
       "   ['OSullivan', 'will', 'also'],\n",
       "   ['will', 'also', 'take'],\n",
       "   ['also', 'take', 'part'],\n",
       "   ['take', 'part', 'in'],\n",
       "   ['part', 'in', 'the'],\n",
       "   ['in', 'the', 'Bupa'],\n",
       "   ['the', 'Bupa', 'Great'],\n",
       "   ['Bupa', 'Great', 'Ireland'],\n",
       "   ['Great', 'Ireland', 'Run'],\n",
       "   ['Ireland', 'Run', 'on'],\n",
       "   ['Run', 'on', '9'],\n",
       "   ['on', '9', 'April'],\n",
       "   ['9', 'April', 'in'],\n",
       "   ['April', 'in', 'Dublin']])]"
      ]
     },
     "execution_count": 165,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "topics_self.take(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "metadata": {},
   "outputs": [],
   "source": [
    "#和所有文件的shingle作比對(拿每個文件自己的shingle set和所有文件製成的shingle set比對)\n",
    "def shingles(x):\n",
    "    shingle = []\n",
    "    for i in sh_set:\n",
    "        if i in x[1]:\n",
    "            shingle.append(\"1\")\n",
    "        else:\n",
    "            shingle.append(\"0\")\n",
    "    return (x[0],shingle)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "metadata": {},
   "outputs": [],
   "source": [
    "topics_shingles = topics_self.map(shingles)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 167,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('001',\n",
       "  ['1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '1',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   ...]),\n",
       " ('002',\n",
       "  ['0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '1',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   '0',\n",
       "   ...])]"
      ]
     },
     "execution_count": 167,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "topics_shingles.take(2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 二、MinHash"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.做出100個不同的hash functions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 373,
   "metadata": {},
   "outputs": [],
   "source": [
    "#h = ((a*x)+b) % c is the standard, accepted way to generate hash functions.\n",
    "#Also, a and b should be random numbers from the range 1 to c-1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 374,
   "metadata": {},
   "outputs": [],
   "source": [
    "#為了確保100的都是不同的function->所有(a,b)的集合裡的個數為100個"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 183,
   "metadata": {},
   "outputs": [],
   "source": [
    "hash_list = [(np.random.randint(low=1, high=3406),np.random.randint(low=1, high=3406)) for i in range(200)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 184,
   "metadata": {},
   "outputs": [],
   "source": [
    "hash_set = set(hash_list)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 185,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "200"
      ]
     },
     "execution_count": 185,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#製作了200個\n",
    "len(hash_set)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "metadata": {},
   "outputs": [],
   "source": [
    "valid_hash = list(hash_set)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 187,
   "metadata": {},
   "outputs": [],
   "source": [
    "#留100個\n",
    "valid_hash = valid_hash[:100]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 176,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(7, 3),\n",
       " (11, 11),\n",
       " (14, 4),\n",
       " (13, 4),\n",
       " (12, 12),\n",
       " (1, 6),\n",
       " (5, 8),\n",
       " (6, 7),\n",
       " (5, 5),\n",
       " (11, 5),\n",
       " (10, 7),\n",
       " (7, 6),\n",
       " (6, 10),\n",
       " (14, 1),\n",
       " (13, 7),\n",
       " (1, 1),\n",
       " (4, 10),\n",
       " (3, 2),\n",
       " (2, 6),\n",
       " (9, 14),\n",
       " (8, 2),\n",
       " (5, 11),\n",
       " (4, 5),\n",
       " (10, 13),\n",
       " (9, 3),\n",
       " (7, 5),\n",
       " (12, 11),\n",
       " (14, 2),\n",
       " (3, 12),\n",
       " (8, 12),\n",
       " (3, 1),\n",
       " (9, 9),\n",
       " (5, 14),\n",
       " (6, 13),\n",
       " (14, 8),\n",
       " (12, 8),\n",
       " (13, 13),\n",
       " (3, 11),\n",
       " (2, 1),\n",
       " (8, 9),\n",
       " (4, 12),\n",
       " (9, 4),\n",
       " (10, 3),\n",
       " (7, 2),\n",
       " (6, 14),\n",
       " (12, 2),\n",
       " (13, 3),\n",
       " (3, 6),\n",
       " (1, 10),\n",
       " (8, 6),\n",
       " (10, 9),\n",
       " (6, 4),\n",
       " (5, 4),\n",
       " (6, 11),\n",
       " (12, 7),\n",
       " (11, 9),\n",
       " (14, 6),\n",
       " (13, 6),\n",
       " (3, 5),\n",
       " (9, 13),\n",
       " (8, 3),\n",
       " (5, 10),\n",
       " (4, 6),\n",
       " (10, 10),\n",
       " (9, 2),\n",
       " (6, 1),\n",
       " (5, 7),\n",
       " (12, 4),\n",
       " (14, 3),\n",
       " (13, 9),\n",
       " (1, 3),\n",
       " (8, 13),\n",
       " (9, 8),\n",
       " (5, 13),\n",
       " (11, 14),\n",
       " (7, 11),\n",
       " (14, 9),\n",
       " (12, 9),\n",
       " (3, 10),\n",
       " (1, 14),\n",
       " (8, 10),\n",
       " (4, 13),\n",
       " (2, 13),\n",
       " (11, 13),\n",
       " (7, 14),\n",
       " (14, 10),\n",
       " (13, 2),\n",
       " (12, 14),\n",
       " (1, 9),\n",
       " (9, 6),\n",
       " (6, 5),\n",
       " (6, 8),\n",
       " (11, 8),\n",
       " (7, 13),\n",
       " (14, 7),\n",
       " (13, 5),\n",
       " (3, 4),\n",
       " (2, 4),\n",
       " (9, 12),\n",
       " (4, 7)]"
      ]
     },
     "execution_count": 176,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "valid_hash"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 375,
   "metadata": {},
   "outputs": [],
   "source": [
    "#定義100個hash function (c = 3407)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i in range(100):\n",
    "    def h(i,x):\n",
    "        return ((valid_hash[i][0]*x)+valid_hash[i][1])%3407"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#算出每個文件在100個hash function下hash100次的100個hash value"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2. minhash製作出每個文件的signature"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 189,
   "metadata": {},
   "outputs": [],
   "source": [
    "def minhashing(x):\n",
    "    signatures = []\n",
    "    #一次一個hash function\n",
    "    for i in range(100):\n",
    "        min_hash = 200\n",
    "        for c in range(len(x[1])):  #len(x)>30000\n",
    "            #只有在shingle是\"1\"的時候，才有hash value\n",
    "            if x[1][c] == \"1\":\n",
    "                # 每次都update最小的min hash value \n",
    "                if min_hash > h(i,c):\n",
    "                    min_hash = h(i,c)\n",
    "        signatures.append(min_hash)\n",
    "    return (x[0],signatures)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 190,
   "metadata": {},
   "outputs": [],
   "source": [
    "minhash = topics_shingles.map(minhashing)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 249,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('001',\n",
       "  [4,\n",
       "   7,\n",
       "   18,\n",
       "   12,\n",
       "   7,\n",
       "   13,\n",
       "   17,\n",
       "   4,\n",
       "   11,\n",
       "   3,\n",
       "   1,\n",
       "   6,\n",
       "   50,\n",
       "   0,\n",
       "   3,\n",
       "   2,\n",
       "   0,\n",
       "   3,\n",
       "   3,\n",
       "   5,\n",
       "   9,\n",
       "   4,\n",
       "   5,\n",
       "   5,\n",
       "   48,\n",
       "   12,\n",
       "   44,\n",
       "   9,\n",
       "   8,\n",
       "   1,\n",
       "   8,\n",
       "   3,\n",
       "   0,\n",
       "   12,\n",
       "   9,\n",
       "   8,\n",
       "   17,\n",
       "   4,\n",
       "   7,\n",
       "   16,\n",
       "   5,\n",
       "   0,\n",
       "   12,\n",
       "   10,\n",
       "   1,\n",
       "   0,\n",
       "   15,\n",
       "   6,\n",
       "   13,\n",
       "   0,\n",
       "   4,\n",
       "   1,\n",
       "   5,\n",
       "   1,\n",
       "   7,\n",
       "   4,\n",
       "   39,\n",
       "   8,\n",
       "   13,\n",
       "   11,\n",
       "   3,\n",
       "   61,\n",
       "   2,\n",
       "   27,\n",
       "   4,\n",
       "   6,\n",
       "   13,\n",
       "   31,\n",
       "   20,\n",
       "   0,\n",
       "   11,\n",
       "   4,\n",
       "   1,\n",
       "   2,\n",
       "   5,\n",
       "   7,\n",
       "   1,\n",
       "   7,\n",
       "   6,\n",
       "   0,\n",
       "   5,\n",
       "   9,\n",
       "   11,\n",
       "   2,\n",
       "   30,\n",
       "   0,\n",
       "   8,\n",
       "   17,\n",
       "   0,\n",
       "   1,\n",
       "   3,\n",
       "   18,\n",
       "   2,\n",
       "   18,\n",
       "   14,\n",
       "   28,\n",
       "   8,\n",
       "   1,\n",
       "   2,\n",
       "   6])]"
      ]
     },
     "execution_count": 249,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "minhash.take(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 三、LSH(b=50,r=2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.將100個siganature2個2個一組分成50組"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 192,
   "metadata": {},
   "outputs": [],
   "source": [
    "#將100個siganature2個2個分成50組\n",
    "def cut_bands(x):\n",
    "    bands = []\n",
    "    for i in range(50):\n",
    "        bands.append((x[1][i*2],x[1][i*2+1]))\n",
    "    return (x[0],bands)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 193,
   "metadata": {},
   "outputs": [],
   "source": [
    "bands = minhash.map(cut_bands)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 194,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('001',\n",
       "  [(4, 7),\n",
       "   (18, 12),\n",
       "   (7, 13),\n",
       "   (17, 4),\n",
       "   (11, 3),\n",
       "   (1, 6),\n",
       "   (50, 0),\n",
       "   (3, 2),\n",
       "   (0, 3),\n",
       "   (3, 5),\n",
       "   (9, 4),\n",
       "   (5, 5),\n",
       "   (48, 12),\n",
       "   (44, 9),\n",
       "   (8, 1),\n",
       "   (8, 3),\n",
       "   (0, 12),\n",
       "   (9, 8),\n",
       "   (17, 4),\n",
       "   (7, 16),\n",
       "   (5, 0),\n",
       "   (12, 10),\n",
       "   (1, 0),\n",
       "   (15, 6),\n",
       "   (13, 0),\n",
       "   (4, 1),\n",
       "   (5, 1),\n",
       "   (7, 4),\n",
       "   (39, 8),\n",
       "   (13, 11),\n",
       "   (3, 61),\n",
       "   (2, 27),\n",
       "   (4, 6),\n",
       "   (13, 31),\n",
       "   (20, 0),\n",
       "   (11, 4),\n",
       "   (1, 2),\n",
       "   (5, 7),\n",
       "   (1, 7),\n",
       "   (6, 0),\n",
       "   (5, 9),\n",
       "   (11, 2),\n",
       "   (30, 0),\n",
       "   (8, 17),\n",
       "   (0, 1),\n",
       "   (3, 18),\n",
       "   (2, 18),\n",
       "   (14, 28),\n",
       "   (8, 1),\n",
       "   (2, 6)])]"
      ]
     },
     "execution_count": 194,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bands.take(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {},
   "outputs": [],
   "source": [
    "#hash to the same bucket for ≧ 1 band"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2.製作出每個文件的50組分別被hash到哪一個bucket"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 195,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 製作一個hash function(這裡我讓每一組(a,b)，(a*23+b)%51)\n",
    "def hash_fun(x):\n",
    "    bucket_ord = []\n",
    "    for i in x[1]:\n",
    "        bucket_ord.append((i[0]*23+i[1])%51)\n",
    "    return (x[0],bucket_ord)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 196,
   "metadata": {},
   "outputs": [],
   "source": [
    "#算出每個(a,b)分別被hash到哪個bucket\n",
    "bands_hash = bands.map(hash_fun)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 273,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('001',\n",
       "  [48,\n",
       "   18,\n",
       "   21,\n",
       "   38,\n",
       "   1,\n",
       "   29,\n",
       "   28,\n",
       "   20,\n",
       "   3,\n",
       "   23,\n",
       "   7,\n",
       "   18,\n",
       "   45,\n",
       "   1,\n",
       "   32,\n",
       "   34,\n",
       "   12,\n",
       "   11,\n",
       "   38,\n",
       "   24,\n",
       "   13,\n",
       "   31,\n",
       "   23,\n",
       "   45,\n",
       "   44,\n",
       "   42,\n",
       "   14,\n",
       "   12,\n",
       "   38,\n",
       "   4,\n",
       "   28,\n",
       "   22,\n",
       "   47,\n",
       "   24,\n",
       "   1,\n",
       "   2,\n",
       "   25,\n",
       "   20,\n",
       "   30,\n",
       "   36,\n",
       "   22,\n",
       "   0,\n",
       "   27,\n",
       "   48,\n",
       "   1,\n",
       "   36,\n",
       "   13,\n",
       "   44,\n",
       "   32,\n",
       "   1])]"
      ]
     },
     "execution_count": 273,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bands_hash.take(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 三、計算相似度\n",
    "\n",
    "邏輯如下:\n",
    "+ 1.紀錄所有文件的(a,b)->屬於哪一個文件、哪一個band(a)、被hash到哪個bucket(b)->(band的index(a),文件編號，所屬bucket的index(b))\n",
    "+ 2.每個band自己做比較: 以band index為key，比較不同文件所屬的bucket->如果bucket的index代表這兩個文件在這個band被認為是相似的\n",
    "+ 3.把每個band認為相似的文件pair加起來(ex.如果對於所有band來說(d1,d2)都是相似的->加起來會是50)就會是兩個文件的相似程度\n",
    "+ 4.算similarity->把加出來的值除以50"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1.紀錄所有文件的(a,b)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 210,
   "metadata": {},
   "outputs": [],
   "source": [
    "#屬於哪一個文件、哪一個band、被hash到哪個bucket->(band的index,文件編號，所屬bucket的index)\n",
    "def index_doc_value(x):\n",
    "    tripple_list = []\n",
    "    for i in range(len(x[1])):\n",
    "        tripple_list.append((i,(x[0],x[1][i])))\n",
    "    return tripple_list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 211,
   "metadata": {},
   "outputs": [],
   "source": [
    "bands_filter = bands_hash.flatMap(index_doc_value)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 212,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(0, ('001', 48)), (1, ('001', 18))]"
      ]
     },
     "execution_count": 212,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bands_filter.take(2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2.每個band自己做比較"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 215,
   "metadata": {},
   "outputs": [],
   "source": [
    "#1.以band index為key分群\n",
    "candidate_filter = bands_filter.groupByKey().map(lambda x: (x[0],list(x[1])))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 277,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(0,\n",
       "  [('001', 48),\n",
       "   ('002', 45),\n",
       "   ('003', 24),\n",
       "   ('004', 11),\n",
       "   ('005', 49),\n",
       "   ('006', 36),\n",
       "   ('007', 50),\n",
       "   ('008', 5),\n",
       "   ('009', 14),\n",
       "   ('010', 27),\n",
       "   ('011', 17),\n",
       "   ('012', 27),\n",
       "   ('013', 18),\n",
       "   ('014', 16),\n",
       "   ('015', 8),\n",
       "   ('016', 48),\n",
       "   ('017', 48),\n",
       "   ('018', 18),\n",
       "   ('019', 49),\n",
       "   ('020', 27),\n",
       "   ('021', 0),\n",
       "   ('022', 41),\n",
       "   ('023', 46),\n",
       "   ('024', 22),\n",
       "   ('025', 36),\n",
       "   ('026', 44),\n",
       "   ('027', 37),\n",
       "   ('028', 44),\n",
       "   ('029', 11),\n",
       "   ('030', 46),\n",
       "   ('031', 19),\n",
       "   ('032', 36),\n",
       "   ('033', 1),\n",
       "   ('034', 9),\n",
       "   ('035', 46),\n",
       "   ('036', 9),\n",
       "   ('037', 24),\n",
       "   ('038', 48),\n",
       "   ('039', 35),\n",
       "   ('040', 1),\n",
       "   ('041', 50),\n",
       "   ('042', 36),\n",
       "   ('043', 15),\n",
       "   ('044', 24),\n",
       "   ('045', 24),\n",
       "   ('046', 32),\n",
       "   ('047', 0),\n",
       "   ('048', 18),\n",
       "   ('049', 0),\n",
       "   ('050', 29),\n",
       "   ('051', 46),\n",
       "   ('052', 19),\n",
       "   ('053', 26),\n",
       "   ('054', 2),\n",
       "   ('055', 41),\n",
       "   ('056', 43),\n",
       "   ('057', 1),\n",
       "   ('058', 23),\n",
       "   ('059', 44),\n",
       "   ('060', 24),\n",
       "   ('061', 25),\n",
       "   ('062', 5),\n",
       "   ('063', 36),\n",
       "   ('064', 4),\n",
       "   ('065', 49),\n",
       "   ('066', 23),\n",
       "   ('067', 36),\n",
       "   ('068', 26),\n",
       "   ('069', 25),\n",
       "   ('070', 1),\n",
       "   ('071', 26),\n",
       "   ('072', 22),\n",
       "   ('073', 43),\n",
       "   ('074', 8),\n",
       "   ('075', 26),\n",
       "   ('076', 18),\n",
       "   ('077', 24),\n",
       "   ('078', 17),\n",
       "   ('079', 28),\n",
       "   ('080', 49),\n",
       "   ('081', 28),\n",
       "   ('082', 5),\n",
       "   ('083', 11),\n",
       "   ('084', 19),\n",
       "   ('085', 13),\n",
       "   ('086', 14),\n",
       "   ('087', 8),\n",
       "   ('088', 0),\n",
       "   ('089', 21),\n",
       "   ('090', 44),\n",
       "   ('091', 24),\n",
       "   ('092', 43),\n",
       "   ('093', 2),\n",
       "   ('094', 25),\n",
       "   ('095', 31),\n",
       "   ('096', 4),\n",
       "   ('097', 42),\n",
       "   ('098', 25),\n",
       "   ('099', 36),\n",
       "   ('100', 11),\n",
       "   ('101', 29)])]"
      ]
     },
     "execution_count": 277,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "candidate_filter.take(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 349,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 2.比較不同文件所屬的bucket->如果bucket的index代表這兩個文件在這個band被認為是相似的\n",
    "def pair_collection(x):\n",
    "    pair_collection = []\n",
    "    #同一個band\n",
    "    #不同文件屬於這個band的部分作比較\n",
    "    for i in range(len(x[1])):\n",
    "        for c in range(len(x[1])):\n",
    "            if i >= c:\n",
    "                continue\n",
    "            #同一個bucket -> 在這個band被認為是相似的\n",
    "            elif x[1][i][1] == x[1][c][1]:\n",
    "                pair_collection.append((x[1][i][0],x[1][c][0]))\n",
    "    return pair_collection"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3.把每個band認為相似的文件pair加起來就會是兩個文件的相似程度\n",
    "+ ex.如果對於所有band來說(d1,d2)都是相似的->加起來會是50"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### (1)method 1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 369,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 用Counter在計算在每個band裡面的相似pair的個數(不管是哪一個candidate pair在同一個band裡的Counter都只會是1)\n",
    "row_count = candidate_filter.map(pair_collection).map(lambda x: Counter(x))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 370,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 把每一個band的Counter加起來\n",
    "all_count = a.reduce(lambda x,y: x+y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 371,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Counter({('001', '016'): 2,\n",
       "         ('001', '017'): 1,\n",
       "         ('001', '038'): 2,\n",
       "         ('003', '037'): 15,\n",
       "         ('003', '044'): 1,\n",
       "         ('003', '045'): 8,\n",
       "         ('003', '060'): 6,\n",
       "         ('003', '077'): 2,\n",
       "         ('003', '091'): 6,\n",
       "         ('004', '029'): 3,\n",
       "         ('004', '083'): 3,\n",
       "         ('004', '100'): 1,\n",
       "         ('005', '019'): 5,\n",
       "         ('005', '065'): 1,\n",
       "         ('005', '080'): 8,\n",
       "         ('006', '025'): 2,\n",
       "         ('006', '032'): 3,\n",
       "         ('006', '042'): 2,\n",
       "         ('006', '063'): 2,\n",
       "         ('006', '067'): 2,\n",
       "         ('006', '099'): 1,\n",
       "         ('007', '041'): 1,\n",
       "         ('008', '062'): 7,\n",
       "         ('008', '082'): 5,\n",
       "         ('009', '086'): 1,\n",
       "         ('010', '012'): 1,\n",
       "         ('010', '020'): 1,\n",
       "         ('011', '078'): 2,\n",
       "         ('012', '020'): 50,\n",
       "         ('013', '018'): 1,\n",
       "         ('013', '048'): 1,\n",
       "         ('013', '076'): 1,\n",
       "         ('015', '074'): 1,\n",
       "         ('015', '087'): 2,\n",
       "         ('016', '017'): 2,\n",
       "         ('016', '038'): 2,\n",
       "         ('017', '038'): 1,\n",
       "         ('018', '048'): 1,\n",
       "         ('018', '076'): 1,\n",
       "         ('019', '065'): 3,\n",
       "         ('019', '080'): 3,\n",
       "         ('021', '047'): 1,\n",
       "         ('021', '049'): 2,\n",
       "         ('021', '088'): 4,\n",
       "         ('022', '055'): 1,\n",
       "         ('023', '030'): 7,\n",
       "         ('023', '035'): 8,\n",
       "         ('023', '051'): 4,\n",
       "         ('024', '072'): 4,\n",
       "         ('025', '032'): 1,\n",
       "         ('025', '042'): 14,\n",
       "         ('025', '063'): 3,\n",
       "         ('025', '067'): 2,\n",
       "         ('025', '099'): 7,\n",
       "         ('026', '028'): 2,\n",
       "         ('026', '059'): 2,\n",
       "         ('026', '090'): 1,\n",
       "         ('028', '059'): 7,\n",
       "         ('028', '090'): 19,\n",
       "         ('029', '083'): 1,\n",
       "         ('029', '100'): 2,\n",
       "         ('030', '035'): 29,\n",
       "         ('030', '051'): 4,\n",
       "         ('031', '052'): 1,\n",
       "         ('031', '084'): 1,\n",
       "         ('032', '042'): 1,\n",
       "         ('032', '063'): 1,\n",
       "         ('032', '067'): 3,\n",
       "         ('032', '099'): 1,\n",
       "         ('033', '040'): 5,\n",
       "         ('033', '057'): 4,\n",
       "         ('033', '070'): 7,\n",
       "         ('034', '036'): 2,\n",
       "         ('035', '051'): 4,\n",
       "         ('037', '044'): 1,\n",
       "         ('037', '045'): 7,\n",
       "         ('037', '060'): 7,\n",
       "         ('037', '077'): 2,\n",
       "         ('037', '091'): 3,\n",
       "         ('040', '057'): 15,\n",
       "         ('040', '070'): 12,\n",
       "         ('042', '063'): 2,\n",
       "         ('042', '067'): 2,\n",
       "         ('042', '099'): 5,\n",
       "         ('044', '045'): 3,\n",
       "         ('044', '060'): 2,\n",
       "         ('044', '077'): 1,\n",
       "         ('044', '091'): 2,\n",
       "         ('045', '060'): 12,\n",
       "         ('045', '077'): 6,\n",
       "         ('045', '091'): 23,\n",
       "         ('047', '049'): 38,\n",
       "         ('047', '088'): 11,\n",
       "         ('048', '076'): 1,\n",
       "         ('049', '088'): 15,\n",
       "         ('050', '101'): 3,\n",
       "         ('052', '084'): 50,\n",
       "         ('053', '068'): 1,\n",
       "         ('053', '071'): 1,\n",
       "         ('053', '075'): 2,\n",
       "         ('054', '093'): 4,\n",
       "         ('056', '073'): 3,\n",
       "         ('056', '092'): 1,\n",
       "         ('057', '070'): 17,\n",
       "         ('058', '066'): 13,\n",
       "         ('059', '090'): 7,\n",
       "         ('060', '077'): 2,\n",
       "         ('060', '091'): 7,\n",
       "         ('061', '069'): 20,\n",
       "         ('061', '094'): 2,\n",
       "         ('061', '098'): 3,\n",
       "         ('062', '082'): 1,\n",
       "         ('063', '067'): 4,\n",
       "         ('063', '099'): 2,\n",
       "         ('064', '096'): 12,\n",
       "         ('065', '080'): 2,\n",
       "         ('067', '099'): 2,\n",
       "         ('068', '071'): 3,\n",
       "         ('068', '075'): 5,\n",
       "         ('069', '094'): 2,\n",
       "         ('069', '098'): 2,\n",
       "         ('071', '075'): 3,\n",
       "         ('073', '092'): 2,\n",
       "         ('074', '087'): 3,\n",
       "         ('077', '091'): 7,\n",
       "         ('079', '081'): 8,\n",
       "         ('083', '100'): 2,\n",
       "         ('094', '098'): 3,\n",
       "         ('001', '012'): 2,\n",
       "         ('001', '020'): 2,\n",
       "         ('001', '028'): 6,\n",
       "         ('001', '029'): 1,\n",
       "         ('001', '058'): 4,\n",
       "         ('002', '047'): 3,\n",
       "         ('002', '049'): 2,\n",
       "         ('002', '051'): 6,\n",
       "         ('002', '076'): 6,\n",
       "         ('002', '081'): 2,\n",
       "         ('002', '088'): 1,\n",
       "         ('003', '046'): 9,\n",
       "         ('003', '065'): 2,\n",
       "         ('004', '052'): 2,\n",
       "         ('004', '070'): 1,\n",
       "         ('004', '084'): 2,\n",
       "         ('005', '036'): 2,\n",
       "         ('005', '068'): 1,\n",
       "         ('009', '064'): 5,\n",
       "         ('009', '073'): 1,\n",
       "         ('009', '080'): 1,\n",
       "         ('009', '096'): 3,\n",
       "         ('010', '061'): 1,\n",
       "         ('010', '069'): 1,\n",
       "         ('010', '093'): 2,\n",
       "         ('011', '063'): 2,\n",
       "         ('011', '074'): 3,\n",
       "         ('011', '083'): 1,\n",
       "         ('012', '028'): 1,\n",
       "         ('012', '029'): 1,\n",
       "         ('012', '058'): 4,\n",
       "         ('013', '027'): 2,\n",
       "         ('014', '098'): 3,\n",
       "         ('015', '034'): 2,\n",
       "         ('015', '057'): 4,\n",
       "         ('015', '086'): 1,\n",
       "         ('015', '092'): 3,\n",
       "         ('016', '071'): 1,\n",
       "         ('016', '082'): 1,\n",
       "         ('017', '030'): 3,\n",
       "         ('017', '035'): 4,\n",
       "         ('018', '043'): 1,\n",
       "         ('018', '079'): 8,\n",
       "         ('020', '028'): 1,\n",
       "         ('020', '029'): 1,\n",
       "         ('020', '058'): 4,\n",
       "         ('021', '039'): 2,\n",
       "         ('023', '025'): 2,\n",
       "         ('026', '100'): 15,\n",
       "         ('028', '029'): 3,\n",
       "         ('028', '058'): 1,\n",
       "         ('029', '058'): 1,\n",
       "         ('031', '054'): 2,\n",
       "         ('031', '075'): 1,\n",
       "         ('031', '094'): 2,\n",
       "         ('033', '099'): 1,\n",
       "         ('034', '057'): 6,\n",
       "         ('034', '086'): 3,\n",
       "         ('034', '092'): 2,\n",
       "         ('036', '068'): 7,\n",
       "         ('037', '048'): 2,\n",
       "         ('037', '089'): 1,\n",
       "         ('040', '066'): 4,\n",
       "         ('043', '079'): 3,\n",
       "         ('046', '065'): 2,\n",
       "         ('047', '051'): 4,\n",
       "         ('047', '076'): 2,\n",
       "         ('047', '081'): 2,\n",
       "         ('048', '089'): 5,\n",
       "         ('049', '051'): 3,\n",
       "         ('049', '076'): 2,\n",
       "         ('049', '081'): 3,\n",
       "         ('050', '059'): 3,\n",
       "         ('050', '085'): 1,\n",
       "         ('051', '076'): 7,\n",
       "         ('051', '081'): 1,\n",
       "         ('051', '088'): 3,\n",
       "         ('052', '070'): 1,\n",
       "         ('053', '060'): 3,\n",
       "         ('053', '090'): 1,\n",
       "         ('054', '075'): 3,\n",
       "         ('054', '094'): 1,\n",
       "         ('057', '086'): 1,\n",
       "         ('057', '092'): 1,\n",
       "         ('059', '085'): 4,\n",
       "         ('060', '090'): 2,\n",
       "         ('061', '093'): 16,\n",
       "         ('062', '097'): 2,\n",
       "         ('063', '074'): 3,\n",
       "         ('063', '078'): 2,\n",
       "         ('063', '083'): 1,\n",
       "         ('064', '073'): 1,\n",
       "         ('064', '080'): 2,\n",
       "         ('069', '093'): 11,\n",
       "         ('070', '084'): 1,\n",
       "         ('071', '082'): 1,\n",
       "         ('072', '087'): 2,\n",
       "         ('073', '080'): 4,\n",
       "         ('073', '096'): 4,\n",
       "         ('074', '078'): 1,\n",
       "         ('074', '083'): 2,\n",
       "         ('075', '094'): 1,\n",
       "         ('076', '081'): 2,\n",
       "         ('076', '088'): 1,\n",
       "         ('078', '083'): 1,\n",
       "         ('080', '096'): 2,\n",
       "         ('081', '088'): 4,\n",
       "         ('086', '092'): 2,\n",
       "         ('001', '092'): 1,\n",
       "         ('002', '016'): 3,\n",
       "         ('002', '036'): 5,\n",
       "         ('002', '068'): 11,\n",
       "         ('002', '077'): 2,\n",
       "         ('002', '091'): 3,\n",
       "         ('004', '018'): 5,\n",
       "         ('004', '054'): 5,\n",
       "         ('004', '079'): 4,\n",
       "         ('006', '065'): 2,\n",
       "         ('006', '085'): 3,\n",
       "         ('009', '023'): 4,\n",
       "         ('009', '034'): 4,\n",
       "         ('009', '048'): 5,\n",
       "         ('009', '057'): 8,\n",
       "         ('010', '029'): 3,\n",
       "         ('010', '030'): 2,\n",
       "         ('010', '035'): 2,\n",
       "         ('010', '098'): 1,\n",
       "         ('011', '097'): 8,\n",
       "         ('012', '055'): 9,\n",
       "         ('014', '067'): 1,\n",
       "         ('014', '089'): 3,\n",
       "         ('014', '101'): 3,\n",
       "         ('015', '071'): 2,\n",
       "         ('015', '075'): 3,\n",
       "         ('016', '036'): 5,\n",
       "         ('016', '051'): 6,\n",
       "         ('016', '068'): 4,\n",
       "         ('016', '077'): 1,\n",
       "         ('016', '091'): 2,\n",
       "         ('017', '052'): 6,\n",
       "         ('017', '078'): 9,\n",
       "         ('017', '084'): 6,\n",
       "         ('018', '054'): 8,\n",
       "         ('020', '055'): 9,\n",
       "         ('021', '032'): 4,\n",
       "         ('021', '056'): 6,\n",
       "         ('021', '062'): 6,\n",
       "         ('021', '081'): 3,\n",
       "         ('021', '093'): 5,\n",
       "         ('022', '026'): 1,\n",
       "         ('022', '099'): 2,\n",
       "         ('023', '034'): 9,\n",
       "         ('023', '048'): 14,\n",
       "         ('023', '057'): 7,\n",
       "         ('024', '027'): 2,\n",
       "         ('024', '041'): 16,\n",
       "         ('025', '058'): 4,\n",
       "         ('025', '066'): 3,\n",
       "         ('026', '099'): 2,\n",
       "         ('027', '041'): 2,\n",
       "         ('028', '100'): 1,\n",
       "         ('029', '030'): 1,\n",
       "         ('029', '035'): 2,\n",
       "         ('029', '098'): 1,\n",
       "         ('030', '098'): 2,\n",
       "         ('031', '039'): 8,\n",
       "         ('031', '072'): 2,\n",
       "         ('031', '080'): 1,\n",
       "         ('032', '056'): 7,\n",
       "         ('032', '062'): 3,\n",
       "         ('032', '081'): 3,\n",
       "         ('032', '088'): 2,\n",
       "         ('032', '093'): 1,\n",
       "         ('033', '050'): 5,\n",
       "         ('033', '094'): 4,\n",
       "         ('034', '048'): 10,\n",
       "         ('035', '098'): 1,\n",
       "         ('036', '051'): 6,\n",
       "         ('036', '077'): 3,\n",
       "         ('036', '091'): 8,\n",
       "         ('037', '053'): 5,\n",
       "         ('038', '061'): 4,\n",
       "         ('038', '069'): 5,\n",
       "         ('039', '072'): 1,\n",
       "         ('039', '080'): 2,\n",
       "         ('040', '047'): 16,\n",
       "         ('040', '049'): 20,\n",
       "         ('042', '058'): 3,\n",
       "         ('042', '066'): 2,\n",
       "         ('043', '059'): 11,\n",
       "         ('044', '076'): 12,\n",
       "         ('046', '087'): 1,\n",
       "         ('047', '070'): 6,\n",
       "         ('048', '057'): 11,\n",
       "         ('049', '070'): 5,\n",
       "         ('050', '094'): 1,\n",
       "         ('051', '068'): 9,\n",
       "         ('051', '077'): 2,\n",
       "         ('051', '091'): 3,\n",
       "         ('052', '078'): 3,\n",
       "         ('054', '079'): 10,\n",
       "         ('056', '062'): 3,\n",
       "         ('056', '081'): 3,\n",
       "         ('056', '088'): 2,\n",
       "         ('056', '093'): 3,\n",
       "         ('062', '081'): 3,\n",
       "         ('062', '088'): 4,\n",
       "         ('062', '093'): 1,\n",
       "         ('063', '082'): 9,\n",
       "         ('065', '085'): 8,\n",
       "         ('067', '089'): 5,\n",
       "         ('067', '101'): 5,\n",
       "         ('068', '077'): 3,\n",
       "         ('068', '091'): 3,\n",
       "         ('072', '080'): 4,\n",
       "         ('074', '097'): 2,\n",
       "         ('078', '084'): 3,\n",
       "         ('081', '093'): 5,\n",
       "         ('083', '096'): 5,\n",
       "         ('088', '093'): 3,\n",
       "         ('089', '101'): 6,\n",
       "         ('001', '013'): 1,\n",
       "         ('001', '097'): 2,\n",
       "         ('002', '017'): 1,\n",
       "         ('003', '021'): 1,\n",
       "         ('003', '029'): 2,\n",
       "         ('003', '099'): 1,\n",
       "         ('003', '101'): 1,\n",
       "         ('004', '058'): 2,\n",
       "         ('006', '031'): 14,\n",
       "         ('006', '081'): 3,\n",
       "         ('006', '087'): 4,\n",
       "         ('007', '012'): 1,\n",
       "         ('007', '020'): 1,\n",
       "         ('007', '054'): 3,\n",
       "         ('007', '055'): 4,\n",
       "         ('009', '027'): 2,\n",
       "         ('009', '033'): 3,\n",
       "         ('009', '083'): 1,\n",
       "         ('010', '059'): 1,\n",
       "         ('011', '022'): 2,\n",
       "         ('011', '049'): 1,\n",
       "         ('011', '088'): 2,\n",
       "         ('012', '054'): 2,\n",
       "         ('013', '097'): 1,\n",
       "         ('014', '024'): 2,\n",
       "         ('014', '040'): 13,\n",
       "         ('016', '045'): 2,\n",
       "         ('016', '086'): 1,\n",
       "         ('016', '100'): 1,\n",
       "         ('019', '090'): 1,\n",
       "         ('020', '054'): 2,\n",
       "         ('021', '029'): 2,\n",
       "         ('021', '099'): 2,\n",
       "         ('021', '101'): 1,\n",
       "         ('022', '049'): 2,\n",
       "         ('022', '088'): 1,\n",
       "         ('023', '091'): 1,\n",
       "         ('024', '040'): 2,\n",
       "         ('025', '037'): 1,\n",
       "         ('025', '060'): 1,\n",
       "         ('025', '071'): 3,\n",
       "         ('026', '092'): 2,\n",
       "         ('027', '033'): 1,\n",
       "         ('027', '083'): 1,\n",
       "         ('029', '099'): 2,\n",
       "         ('029', '101'): 2,\n",
       "         ('030', '091'): 2,\n",
       "         ('031', '081'): 2,\n",
       "         ('031', '087'): 3,\n",
       "         ('033', '083'): 1,\n",
       "         ('034', '064'): 2,\n",
       "         ('035', '091'): 3,\n",
       "         ('037', '071'): 1,\n",
       "         ('042', '047'): 1,\n",
       "         ('042', '061'): 1,\n",
       "         ('042', '069'): 1,\n",
       "         ('042', '076'): 1,\n",
       "         ('042', '093'): 1,\n",
       "         ('043', '080'): 1,\n",
       "         ('044', '063'): 2,\n",
       "         ('044', '085'): 1,\n",
       "         ('044', '096'): 3,\n",
       "         ('045', '086'): 2,\n",
       "         ('045', '100'): 4,\n",
       "         ('046', '048'): 2,\n",
       "         ('046', '066'): 2,\n",
       "         ('047', '061'): 4,\n",
       "         ('047', '069'): 5,\n",
       "         ('047', '093'): 5,\n",
       "         ('048', '066'): 5,\n",
       "         ('050', '053'): 3,\n",
       "         ('052', '065'): 2,\n",
       "         ('052', '072'): 2,\n",
       "         ('054', '055'): 1,\n",
       "         ('056', '067'): 2,\n",
       "         ('057', '082'): 11,\n",
       "         ('058', '079'): 1,\n",
       "         ('060', '071'): 2,\n",
       "         ('061', '076'): 1,\n",
       "         ('063', '085'): 1,\n",
       "         ('063', '096'): 1,\n",
       "         ('065', '072'): 2,\n",
       "         ('065', '084'): 2,\n",
       "         ('069', '076'): 3,\n",
       "         ('070', '075'): 2,\n",
       "         ('070', '089'): 3,\n",
       "         ('072', '084'): 2,\n",
       "         ('075', '089'): 7,\n",
       "         ('076', '093'): 1,\n",
       "         ('081', '087'): 3,\n",
       "         ('085', '096'): 1,\n",
       "         ('086', '100'): 1,\n",
       "         ('099', '101'): 3,\n",
       "         ('001', '023'): 2,\n",
       "         ('001', '040'): 2,\n",
       "         ('001', '057'): 1,\n",
       "         ('002', '029'): 6,\n",
       "         ('003', '018'): 3,\n",
       "         ('004', '014'): 2,\n",
       "         ('004', '027'): 2,\n",
       "         ('004', '055'): 1,\n",
       "         ('005', '012'): 2,\n",
       "         ('005', '020'): 2,\n",
       "         ('005', '024'): 1,\n",
       "         ('005', '034'): 2,\n",
       "         ('005', '041'): 3,\n",
       "         ('005', '047'): 1,\n",
       "         ('005', '049'): 1,\n",
       "         ('005', '058'): 3,\n",
       "         ('005', '066'): 1,\n",
       "         ('005', '072'): 2,\n",
       "         ('005', '088'): 3,\n",
       "         ('006', '039'): 9,\n",
       "         ('006', '100'): 1,\n",
       "         ('007', '022'): 1,\n",
       "         ('007', '056'): 9,\n",
       "         ('009', '091'): 3,\n",
       "         ('010', '073'): 1,\n",
       "         ('012', '024'): 1,\n",
       "         ('012', '034'): 1,\n",
       "         ('012', '041'): 1,\n",
       "         ('012', '047'): 6,\n",
       "         ('012', '049'): 4,\n",
       "         ('012', '066'): 3,\n",
       "         ('012', '072'): 4,\n",
       "         ('012', '080'): 4,\n",
       "         ('012', '088'): 7,\n",
       "         ('014', '027'): 2,\n",
       "         ('014', '055'): 3,\n",
       "         ('016', '085'): 1,\n",
       "         ('016', '101'): 1,\n",
       "         ('017', '044'): 1,\n",
       "         ('017', '063'): 2,\n",
       "         ('017', '095'): 2,\n",
       "         ('019', '069'): 5,\n",
       "         ('020', '024'): 1,\n",
       "         ('020', '034'): 1,\n",
       "         ('020', '041'): 1,\n",
       "         ('020', '047'): 6,\n",
       "         ('020', '049'): 4,\n",
       "         ('020', '066'): 3,\n",
       "         ('020', '072'): 4,\n",
       "         ('020', '080'): 4,\n",
       "         ('020', '088'): 7,\n",
       "         ('021', '059'): 2,\n",
       "         ('022', '056'): 3,\n",
       "         ('023', '038'): 14,\n",
       "         ('023', '040'): 11,\n",
       "         ('024', '034'): 2,\n",
       "         ('024', '047'): 2,\n",
       "         ('024', '049'): 4,\n",
       "         ('024', '058'): 3,\n",
       "         ('024', '066'): 5,\n",
       "         ('024', '080'): 2,\n",
       "         ('024', '088'): 1,\n",
       "         ('026', '075'): 4,\n",
       "         ('026', '086'): 2,\n",
       "         ('027', '055'): 3,\n",
       "         ('029', '076'): 6,\n",
       "         ('029', '081'): 3,\n",
       "         ('030', '036'): 2,\n",
       "         ('031', '032'): 1,\n",
       "         ('033', '067'): 2,\n",
       "         ('034', '041'): 2,\n",
       "         ('034', '047'): 5,\n",
       "         ('034', '049'): 8,\n",
       "         ('034', '058'): 3,\n",
       "         ('034', '066'): 4,\n",
       "         ('034', '072'): 3,\n",
       "         ('034', '080'): 2,\n",
       "         ('034', '088'): 3,\n",
       "         ('035', '036'): 2,\n",
       "         ('038', '040'): 1,\n",
       "         ('038', '057'): 2,\n",
       "         ('039', '100'): 1,\n",
       "         ('041', '047'): 2,\n",
       "         ('041', '049'): 2,\n",
       "         ('041', '058'): 4,\n",
       "         ('041', '066'): 4,\n",
       "         ('041', '072'): 3,\n",
       "         ('041', '080'): 2,\n",
       "         ('041', '088'): 1,\n",
       "         ('042', '046'): 2,\n",
       "         ('042', '097'): 3,\n",
       "         ('043', '052'): 2,\n",
       "         ('043', '084'): 2,\n",
       "         ('044', '095'): 2,\n",
       "         ('045', '079'): 1,\n",
       "         ('046', '097'): 2,\n",
       "         ('047', '058'): 7,\n",
       "         ('047', '066'): 5,\n",
       "         ('047', '072'): 1,\n",
       "         ('047', '080'): 8,\n",
       "         ('049', '058'): 8,\n",
       "         ('049', '066'): 7,\n",
       "         ('049', '072'): 1,\n",
       "         ('049', '080'): 3,\n",
       "         ('050', '077'): 2,\n",
       "         ('050', '089'): 3,\n",
       "         ('051', '053'): 1,\n",
       "         ('051', '092'): 2,\n",
       "         ('053', '092'): 7,\n",
       "         ('054', '082'): 2,\n",
       "         ('054', '099'): 1,\n",
       "         ('058', '072'): 8,\n",
       "         ('058', '080'): 1,\n",
       "         ('058', '088'): 8,\n",
       "         ('059', '062'): 1,\n",
       "         ('060', '079'): 1,\n",
       "         ('063', '095'): 6,\n",
       "         ('064', '083'): 7,\n",
       "         ('065', '071'): 3,\n",
       "         ('066', '072'): 6,\n",
       "         ('066', '080'): 2,\n",
       "         ('066', '088'): 8,\n",
       "         ('068', '070'): 2,\n",
       "         ('072', '088'): 2,\n",
       "         ('075', '086'): 1,\n",
       "         ('077', '089'): 1,\n",
       "         ('078', '087'): 3,\n",
       "         ('080', '088'): 3,\n",
       "         ('082', '099'): 2,\n",
       "         ('085', '101'): 3,\n",
       "         ('001', '007'): 1,\n",
       "         ('001', '025'): 2,\n",
       "         ('001', '061'): 2,\n",
       "         ('001', '065'): 1,\n",
       "         ('001', '071'): 1,\n",
       "         ('001', '073'): 1,\n",
       "         ('002', '028'): 4,\n",
       "         ('002', '090'): 5,\n",
       "         ('003', '042'): 1,\n",
       "         ('007', '025'): 2,\n",
       "         ('007', '061'): 4,\n",
       "         ('007', '065'): 2,\n",
       "         ('007', '071'): 2,\n",
       "         ('007', '073'): 2,\n",
       "         ('007', '097'): 2,\n",
       "         ('008', '021'): 5,\n",
       "         ('008', '033'): 6,\n",
       "         ('008', '094'): 7,\n",
       "         ('010', '095'): 2,\n",
       "         ('011', '015'): 2,\n",
       "         ('011', '058'): 3,\n",
       "         ('012', '099'): 2,\n",
       "         ('014', '030'): 3,\n",
       "         ('014', '035'): 2,\n",
       "         ('014', '043'): 7,\n",
       "         ('014', '050'): 3,\n",
       "         ('014', '059'): 2,\n",
       "         ('014', '069'): 2,\n",
       "         ('014', '072'): 2,\n",
       "         ('014', '075'): 4,\n",
       "         ('014', '076'): 2,\n",
       "         ('015', '058'): 3,\n",
       "         ('016', '089'): 3,\n",
       "         ('018', '056'): 1,\n",
       "         ('018', '063'): 3,\n",
       "         ('020', '099'): 2,\n",
       "         ('021', '033'): 1,\n",
       "         ('021', '082'): 2,\n",
       "         ('021', '094'): 1,\n",
       "         ('022', '040'): 4,\n",
       "         ('022', '057'): 9,\n",
       "         ('022', '068'): 2,\n",
       "         ('022', '079'): 1,\n",
       "         ('022', '081'): 3,\n",
       "         ('023', '026'): 1,\n",
       "         ('023', '067'): 1,\n",
       "         ('024', '087'): 2,\n",
       "         ('025', '061'): 2,\n",
       "         ('025', '065'): 2,\n",
       "         ('025', '073'): 8,\n",
       "         ('025', '097'): 1,\n",
       "         ('026', '067'): 4,\n",
       "         ('027', '101'): 19,\n",
       "         ('030', '043'): 3,\n",
       "         ('030', '050'): 3,\n",
       "         ('030', '059'): 6,\n",
       "         ('030', '069'): 3,\n",
       "         ('030', '072'): 2,\n",
       "         ('030', '075'): 4,\n",
       "         ('030', '076'): 2,\n",
       "         ('032', '052'): 1,\n",
       "         ('032', '084'): 1,\n",
       "         ('033', '082'): 10,\n",
       "         ('034', '100'): 1,\n",
       "         ('035', '043'): 1,\n",
       "         ('035', '050'): 2,\n",
       "         ('035', '059'): 4,\n",
       "         ('035', '069'): 4,\n",
       "         ('035', '072'): 3,\n",
       "         ('035', '075'): 3,\n",
       "         ('035', '076'): 1,\n",
       "         ('037', '041'): 1,\n",
       "         ('038', '086'): 4,\n",
       "         ('040', '068'): 2,\n",
       "         ('040', '079'): 2,\n",
       "         ('040', '081'): 2,\n",
       "         ('043', '050'): 5,\n",
       "         ('043', '069'): 2,\n",
       "         ('043', '072'): 1,\n",
       "         ('043', '075'): 9,\n",
       "         ('043', '076'): 3,\n",
       "         ('046', '055'): 1,\n",
       "         ('047', '048'): 14,\n",
       "         ('047', '062'): 2,\n",
       "         ('048', '049'): 18,\n",
       "         ('048', '051'): 3,\n",
       "         ('048', '062'): 1,\n",
       "         ('048', '080'): 1,\n",
       "         ('048', '088'): 2,\n",
       "         ('049', '062'): 2,\n",
       "         ('050', '069'): 1,\n",
       "         ('050', '072'): 3,\n",
       "         ('050', '075'): 5,\n",
       "         ('050', '076'): 3,\n",
       "         ('051', '062'): 1,\n",
       "         ('051', '080'): 2,\n",
       "         ('053', '098'): 2,\n",
       "         ('056', '063'): 2,\n",
       "         ('057', '068'): 2,\n",
       "         ('057', '079'): 3,\n",
       "         ('057', '081'): 1,\n",
       "         ('059', '069'): 1,\n",
       "         ('059', '072'): 1,\n",
       "         ('059', '075'): 7,\n",
       "         ('059', '076'): 3,\n",
       "         ('061', '065'): 1,\n",
       "         ('061', '071'): 4,\n",
       "         ('061', '073'): 1,\n",
       "         ('061', '097'): 1,\n",
       "         ('062', '080'): 2,\n",
       "         ('065', '073'): 3,\n",
       "         ('065', '097'): 13,\n",
       "         ('066', '092'): 2,\n",
       "         ('068', '079'): 1,\n",
       "         ('068', '081'): 2,\n",
       "         ('069', '072'): 1,\n",
       "         ('069', '075'): 2,\n",
       "         ('071', '073'): 3,\n",
       "         ('071', '097'): 6,\n",
       "         ('072', '075'): 2,\n",
       "         ('072', '076'): 2,\n",
       "         ('073', '097'): 3,\n",
       "         ('075', '076'): 1,\n",
       "         ('077', '078'): 3,\n",
       "         ('082', '094'): 1,\n",
       "         ('093', '095'): 1,\n",
       "         ('001', '018'): 1,\n",
       "         ('002', '010'): 1,\n",
       "         ('002', '052'): 1,\n",
       "         ('002', '056'): 1,\n",
       "         ('002', '084'): 1,\n",
       "         ('003', '016'): 1,\n",
       "         ('003', '097'): 3,\n",
       "         ('004', '009'): 1,\n",
       "         ('004', '059'): 1,\n",
       "         ('004', '060'): 2,\n",
       "         ('004', '064'): 2,\n",
       "         ('004', '074'): 3,\n",
       "         ('005', '082'): 2,\n",
       "         ('006', '027'): 1,\n",
       "         ('006', '055'): 8,\n",
       "         ('007', '072'): 2,\n",
       "         ('009', '059'): 3,\n",
       "         ('009', '060'): 1,\n",
       "         ('009', '074'): 2,\n",
       "         ('010', '052'): 4,\n",
       "         ('010', '056'): 1,\n",
       "         ('010', '084'): 4,\n",
       "         ('010', '090'): 3,\n",
       "         ('011', '065'): 3,\n",
       "         ('012', '061'): 3,\n",
       "         ('013', '035'): 3,\n",
       "         ('014', '019'): 2,\n",
       "         ('014', '070'): 1,\n",
       "         ('015', '053'): 3,\n",
       "         ('016', '097'): 1,\n",
       "         ('017', '025'): 2,\n",
       "         ('017', '042'): 4,\n",
       "         ('017', '045'): 9,\n",
       "         ('017', '050'): 2,\n",
       "         ('019', '040'): 2,\n",
       "         ('019', '043'): 2,\n",
       "         ('019', '070'): 3,\n",
       "         ('019', '101'): 1,\n",
       "         ('020', '061'): 3,\n",
       "         ('021', '077'): 1,\n",
       "         ('021', '083'): 1,\n",
       "         ('022', '030'): 1,\n",
       "         ('023', '047'): 17,\n",
       "         ('023', '049'): 10,\n",
       "         ('023', '073'): 1,\n",
       "         ('023', '092'): 2,\n",
       "         ('023', '096'): 1,\n",
       "         ('023', '099'): 1,\n",
       "         ('024', '033'): 2,\n",
       "         ('024', '068'): 1,\n",
       "         ('024', '081'): 2,\n",
       "         ('025', '045'): 1,\n",
       "         ('025', '050'): 2,\n",
       "         ('027', '031'): 2,\n",
       "         ('028', '046'): 1,\n",
       "         ('028', '054'): 1,\n",
       "         ('031', '055'): 11,\n",
       "         ('033', '068'): 1,\n",
       "         ('033', '081'): 3,\n",
       "         ('034', '078'): 2,\n",
       "         ('036', '063'): 4,\n",
       "         ('036', '067'): 2,\n",
       "         ('037', '085'): 2,\n",
       "         ('038', '062'): 2,\n",
       "         ('038', '071'): 2,\n",
       "         ('039', '066'): 1,\n",
       "         ('039', '088'): 2,\n",
       "         ('040', '043'): 4,\n",
       "         ('040', '069'): 1,\n",
       "         ('040', '101'): 1,\n",
       "         ('041', '082'): 1,\n",
       "         ('042', '045'): 2,\n",
       "         ('042', '050'): 1,\n",
       "         ('043', '070'): 2,\n",
       "         ('043', '101'): 5,\n",
       "         ('044', '087'): 2,\n",
       "         ('044', '093'): 1,\n",
       "         ('045', '050'): 2,\n",
       "         ('046', '054'): 3,\n",
       "         ('047', '073'): 2,\n",
       "         ('047', '092'): 2,\n",
       "         ('047', '096'): 1,\n",
       "         ('047', '099'): 2,\n",
       "         ('048', '073'): 3,\n",
       "         ('048', '092'): 2,\n",
       "         ('048', '096'): 2,\n",
       "         ('048', '099'): 2,\n",
       "         ('049', '073'): 4,\n",
       "         ('049', '092'): 3,\n",
       "         ('049', '096'): 1,\n",
       "         ('049', '099'): 2,\n",
       "         ('051', '089'): 2,\n",
       "         ('052', '056'): 2,\n",
       "         ('052', '090'): 2,\n",
       "         ('053', '057'): 1,\n",
       "         ('056', '084'): 2,\n",
       "         ('056', '090'): 1,\n",
       "         ('058', '082'): 1,\n",
       "         ('059', '060'): 1,\n",
       "         ('059', '064'): 1,\n",
       "         ('059', '074'): 3,\n",
       "         ('060', '064'): 3,\n",
       "         ('060', '074'): 2,\n",
       "         ('062', '071'): 2,\n",
       "         ('064', '074'): 2,\n",
       "         ('069', '070'): 1,\n",
       "         ('069', '101'): 1,\n",
       "         ('070', '101'): 1,\n",
       "         ('073', '099'): 8,\n",
       "         ('076', '098'): 2,\n",
       "         ('077', '083'): 2,\n",
       "         ('084', '090'): 2,\n",
       "         ('087', '093'): 3,\n",
       "         ('092', '096'): 1,\n",
       "         ('092', '099'): 1,\n",
       "         ('094', '095'): 2,\n",
       "         ('096', '099'): 1,\n",
       "         ('001', '043'): 1,\n",
       "         ('002', '053'): 2,\n",
       "         ('002', '065'): 2,\n",
       "         ('004', '025'): 2,\n",
       "         ('004', '071'): 1,\n",
       "         ('004', '073'): 2,\n",
       "         ('005', '013'): 2,\n",
       "         ('006', '044'): 1,\n",
       "         ('007', '021'): 5,\n",
       "         ('007', '030'): 3,\n",
       "         ('007', '032'): 9,\n",
       "         ('007', '035'): 2,\n",
       "         ('007', '081'): 3,\n",
       "         ('008', '017'): 2,\n",
       "         ('008', '085'): 1,\n",
       "         ('009', '015'): 2,\n",
       "         ('009', '070'): 12,\n",
       "         ('009', '095'): 4,\n",
       "         ('010', '094'): 3,\n",
       "         ('011', '072'): 5,\n",
       "         ('011', '086'): 11,\n",
       "         ('014', '045'): 1,\n",
       "         ('014', '060'): 4,\n",
       "         ('014', '078'): 1,\n",
       "         ('014', '091'): 2,\n",
       "         ('015', '070'): 1,\n",
       "         ('015', '095'): 2,\n",
       "         ('016', '033'): 2,\n",
       "         ('016', '064'): 2,\n",
       "         ('016', '076'): 15,\n",
       "         ('017', '085'): 1,\n",
       "         ('019', '088'): 2,\n",
       "         ('021', '030'): 1,\n",
       "         ('021', '035'): 2,\n",
       "         ('021', '061'): 3,\n",
       "         ('022', '101'): 2,\n",
       "         ('023', '058'): 5,\n",
       "         ('023', '062'): 1,\n",
       "         ('024', '074'): 3,\n",
       "         ('025', '029'): 5,\n",
       "         ('026', '083'): 3,\n",
       "         ('026', '087'): 3,\n",
       "         ('029', '071'): 2,\n",
       "         ('029', '073'): 3,\n",
       "         ('030', '032'): 1,\n",
       "         ('030', '056'): 1,\n",
       "         ('030', '061'): 4,\n",
       "         ('030', '081'): 2,\n",
       "         ('032', '035'): 1,\n",
       "         ('032', '061'): 3,\n",
       "         ('033', '064'): 2,\n",
       "         ('033', '076'): 2,\n",
       "         ('034', '037'): 1,\n",
       "         ('034', '096'): 2,\n",
       "         ('035', '056'): 1,\n",
       "         ('035', '061'): 2,\n",
       "         ('035', '081'): 2,\n",
       "         ('036', '100'): 2,\n",
       "         ('037', '066'): 2,\n",
       "         ('037', '096'): 1,\n",
       "         ('038', '047'): 6,\n",
       "         ('038', '049'): 2,\n",
       "         ('038', '058'): 7,\n",
       "         ('038', '092'): 3,\n",
       "         ('045', '078'): 6,\n",
       "         ('051', '100'): 1,\n",
       "         ('053', '065'): 1,\n",
       "         ('055', '079'): 3,\n",
       "         ('055', '090'): 2,\n",
       "         ('056', '061'): 1,\n",
       "         ('057', '095'): 3,\n",
       "         ('058', '062'): 1,\n",
       "         ('058', '092'): 2,\n",
       "         ('059', '068'): 6,\n",
       "         ('060', '078'): 5,\n",
       "         ('061', '081'): 3,\n",
       "         ('062', '092'): 4,\n",
       "         ('063', '093'): 1,\n",
       "         ('064', '076'): 1,\n",
       "         ('066', '096'): 1,\n",
       "         ('070', '095'): 6,\n",
       "         ('072', '086'): 6,\n",
       "         ('072', '097'): 2,\n",
       "         ('078', '091'): 3,\n",
       "         ('079', '090'): 1,\n",
       "         ('083', '087'): 1,\n",
       "         ('086', '097'): 6,\n",
       "         ('001', '044'): 7,\n",
       "         ('001', '059'): 3,\n",
       "         ('001', '090'): 6,\n",
       "         ('003', '052'): 4,\n",
       "         ('003', '084'): 4,\n",
       "         ('006', '033'): 2,\n",
       "         ('007', '053'): 2,\n",
       "         ('008', '088'): 2,\n",
       "         ('010', '018'): 1,\n",
       "         ('011', '071'): 2,\n",
       "         ('012', '017'): 3,\n",
       "         ('012', '030'): 4,\n",
       "         ('012', '035'): 2,\n",
       "         ('012', '051'): 4,\n",
       "         ('012', '068'): 1,\n",
       "         ('013', '093'): 1,\n",
       "         ('013', '099'): 9,\n",
       "         ('014', '066'): 6,\n",
       "         ('014', '086'): 1,\n",
       "         ('016', '024'): 2,\n",
       "         ('017', '020'): 3,\n",
       "         ('017', '051'): 2,\n",
       "         ('017', '068'): 1,\n",
       "         ('020', '030'): 4,\n",
       "         ('020', '035'): 2,\n",
       "         ('020', '051'): 4,\n",
       "         ('020', '068'): 1,\n",
       "         ('021', '026'): 2,\n",
       "         ('021', '075'): 1,\n",
       "         ('021', '092'): 1,\n",
       "         ('021', '100'): 1,\n",
       "         ('022', '025'): 3,\n",
       "         ('022', '036'): 1,\n",
       "         ('022', '063'): 7,\n",
       "         ('022', '094'): 6,\n",
       "         ('024', '076'): 2,\n",
       "         ('025', '036'): 2,\n",
       "         ('025', '081'): 2,\n",
       "         ('025', '094'): 1,\n",
       "         ('027', '067'): 5,\n",
       "         ('028', '044'): 3,\n",
       "         ('029', '032'): 1,\n",
       "         ('029', '061'): 1,\n",
       "         ('029', '069'): 1,\n",
       "         ('030', '068'): 3,\n",
       "         ('031', '033'): 1,\n",
       "         ('031', '042'): 1,\n",
       "         ('031', '085'): 3,\n",
       "         ('032', '069'): 1,\n",
       "         ('033', '042'): 2,\n",
       "         ('033', '055'): 1,\n",
       "         ('033', '085'): 1,\n",
       "         ('034', '040'): 11,\n",
       "         ('034', '089'): 1,\n",
       "         ('035', '068'): 2,\n",
       "         ('036', '081'): 2,\n",
       "         ('036', '094'): 1,\n",
       "         ('037', '078'): 9,\n",
       "         ('037', '080'): 1,\n",
       "         ('040', '048'): 15,\n",
       "         ('040', '089'): 3,\n",
       "         ('042', '055'): 1,\n",
       "         ('042', '085'): 1,\n",
       "         ('044', '059'): 5,\n",
       "         ('044', '090'): 3,\n",
       "         ('045', '052'): 5,\n",
       "         ('045', '084'): 5,\n",
       "         ('046', '056'): 1,\n",
       "         ('046', '073'): 2,\n",
       "         ('049', '089'): 3,\n",
       "         ('052', '091'): 6,\n",
       "         ('055', '085'): 2,\n",
       "         ('057', '096'): 1,\n",
       "         ('060', '066'): 2,\n",
       "         ('060', '072'): 1,\n",
       "         ('060', '086'): 1,\n",
       "         ('063', '081'): 1,\n",
       "         ('063', '094'): 5,\n",
       "         ('065', '074'): 3,\n",
       "         ('066', '086'): 1,\n",
       "         ('070', '096'): 2,\n",
       "         ('075', '092'): 1,\n",
       "         ('075', '100'): 3,\n",
       "         ('077', '079'): 1,\n",
       "         ('078', '080'): 1,\n",
       "         ('081', '094'): 2,\n",
       "         ('082', '083'): 1,\n",
       "         ('084', '091'): 6,\n",
       "         ('087', '098'): 4,\n",
       "         ('092', '100'): 3,\n",
       "         ('093', '099'): 1,\n",
       "         ('001', '030'): 2,\n",
       "         ('001', '035'): 2,\n",
       "         ('001', '051'): 4,\n",
       "         ('002', '055'): 2,\n",
       "         ('003', '082'): 1,\n",
       "         ('004', '026'): 1,\n",
       "         ('004', '096'): 2,\n",
       "         ...})"
      ]
     },
     "execution_count": 371,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "all_count"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### (2)method 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 372,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 用Flatmap把每一個band的candidate pair放在同一地方(我們不在乎candidate pair是哪一個band，只在乎個數)\n",
    "candidate_filter1 = candidate_filter.map(pair_collection).flatMap(lambda x: x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 307,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('001', '016')]"
      ]
     },
     "execution_count": 307,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "candidate_filter1.take(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 303,
   "metadata": {},
   "outputs": [],
   "source": [
    "resume = list(candidate_filter1.collect())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 312,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 算出candidate pair分別被多少個band認為是相似的\n",
    "Count = Counter(resume)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 313,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Counter({('001', '016'): 2,\n",
       "         ('001', '017'): 1,\n",
       "         ('001', '038'): 2,\n",
       "         ('003', '037'): 15,\n",
       "         ('003', '044'): 1,\n",
       "         ('003', '045'): 8,\n",
       "         ('003', '060'): 6,\n",
       "         ('003', '077'): 2,\n",
       "         ('003', '091'): 6,\n",
       "         ('004', '029'): 3,\n",
       "         ('004', '083'): 3,\n",
       "         ('004', '100'): 1,\n",
       "         ('005', '019'): 5,\n",
       "         ('005', '065'): 1,\n",
       "         ('005', '080'): 8,\n",
       "         ('006', '025'): 2,\n",
       "         ('006', '032'): 3,\n",
       "         ('006', '042'): 2,\n",
       "         ('006', '063'): 2,\n",
       "         ('006', '067'): 2,\n",
       "         ('006', '099'): 1,\n",
       "         ('007', '041'): 1,\n",
       "         ('008', '062'): 7,\n",
       "         ('008', '082'): 5,\n",
       "         ('009', '086'): 1,\n",
       "         ('010', '012'): 1,\n",
       "         ('010', '020'): 1,\n",
       "         ('011', '078'): 2,\n",
       "         ('012', '020'): 50,\n",
       "         ('013', '018'): 1,\n",
       "         ('013', '048'): 1,\n",
       "         ('013', '076'): 1,\n",
       "         ('015', '074'): 1,\n",
       "         ('015', '087'): 2,\n",
       "         ('016', '017'): 2,\n",
       "         ('016', '038'): 2,\n",
       "         ('017', '038'): 1,\n",
       "         ('018', '048'): 1,\n",
       "         ('018', '076'): 1,\n",
       "         ('019', '065'): 3,\n",
       "         ('019', '080'): 3,\n",
       "         ('021', '047'): 1,\n",
       "         ('021', '049'): 2,\n",
       "         ('021', '088'): 4,\n",
       "         ('022', '055'): 1,\n",
       "         ('023', '030'): 7,\n",
       "         ('023', '035'): 8,\n",
       "         ('023', '051'): 4,\n",
       "         ('024', '072'): 4,\n",
       "         ('025', '032'): 1,\n",
       "         ('025', '042'): 14,\n",
       "         ('025', '063'): 3,\n",
       "         ('025', '067'): 2,\n",
       "         ('025', '099'): 7,\n",
       "         ('026', '028'): 2,\n",
       "         ('026', '059'): 2,\n",
       "         ('026', '090'): 1,\n",
       "         ('028', '059'): 7,\n",
       "         ('028', '090'): 19,\n",
       "         ('029', '083'): 1,\n",
       "         ('029', '100'): 2,\n",
       "         ('030', '035'): 29,\n",
       "         ('030', '051'): 4,\n",
       "         ('031', '052'): 1,\n",
       "         ('031', '084'): 1,\n",
       "         ('032', '042'): 1,\n",
       "         ('032', '063'): 1,\n",
       "         ('032', '067'): 3,\n",
       "         ('032', '099'): 1,\n",
       "         ('033', '040'): 5,\n",
       "         ('033', '057'): 4,\n",
       "         ('033', '070'): 7,\n",
       "         ('034', '036'): 2,\n",
       "         ('035', '051'): 4,\n",
       "         ('037', '044'): 1,\n",
       "         ('037', '045'): 7,\n",
       "         ('037', '060'): 7,\n",
       "         ('037', '077'): 2,\n",
       "         ('037', '091'): 3,\n",
       "         ('040', '057'): 15,\n",
       "         ('040', '070'): 12,\n",
       "         ('042', '063'): 2,\n",
       "         ('042', '067'): 2,\n",
       "         ('042', '099'): 5,\n",
       "         ('044', '045'): 3,\n",
       "         ('044', '060'): 2,\n",
       "         ('044', '077'): 1,\n",
       "         ('044', '091'): 2,\n",
       "         ('045', '060'): 12,\n",
       "         ('045', '077'): 6,\n",
       "         ('045', '091'): 23,\n",
       "         ('047', '049'): 38,\n",
       "         ('047', '088'): 11,\n",
       "         ('048', '076'): 1,\n",
       "         ('049', '088'): 15,\n",
       "         ('050', '101'): 3,\n",
       "         ('052', '084'): 50,\n",
       "         ('053', '068'): 1,\n",
       "         ('053', '071'): 1,\n",
       "         ('053', '075'): 2,\n",
       "         ('054', '093'): 4,\n",
       "         ('056', '073'): 3,\n",
       "         ('056', '092'): 1,\n",
       "         ('057', '070'): 17,\n",
       "         ('058', '066'): 13,\n",
       "         ('059', '090'): 7,\n",
       "         ('060', '077'): 2,\n",
       "         ('060', '091'): 7,\n",
       "         ('061', '069'): 20,\n",
       "         ('061', '094'): 2,\n",
       "         ('061', '098'): 3,\n",
       "         ('062', '082'): 1,\n",
       "         ('063', '067'): 4,\n",
       "         ('063', '099'): 2,\n",
       "         ('064', '096'): 12,\n",
       "         ('065', '080'): 2,\n",
       "         ('067', '099'): 2,\n",
       "         ('068', '071'): 3,\n",
       "         ('068', '075'): 5,\n",
       "         ('069', '094'): 2,\n",
       "         ('069', '098'): 2,\n",
       "         ('071', '075'): 3,\n",
       "         ('073', '092'): 2,\n",
       "         ('074', '087'): 3,\n",
       "         ('077', '091'): 7,\n",
       "         ('079', '081'): 8,\n",
       "         ('083', '100'): 2,\n",
       "         ('094', '098'): 3,\n",
       "         ('001', '012'): 2,\n",
       "         ('001', '020'): 2,\n",
       "         ('001', '028'): 6,\n",
       "         ('001', '029'): 1,\n",
       "         ('001', '058'): 4,\n",
       "         ('002', '047'): 3,\n",
       "         ('002', '049'): 2,\n",
       "         ('002', '051'): 6,\n",
       "         ('002', '076'): 6,\n",
       "         ('002', '081'): 2,\n",
       "         ('002', '088'): 1,\n",
       "         ('003', '046'): 9,\n",
       "         ('003', '065'): 2,\n",
       "         ('004', '052'): 2,\n",
       "         ('004', '070'): 1,\n",
       "         ('004', '084'): 2,\n",
       "         ('005', '036'): 2,\n",
       "         ('005', '068'): 1,\n",
       "         ('009', '064'): 5,\n",
       "         ('009', '073'): 1,\n",
       "         ('009', '080'): 1,\n",
       "         ('009', '096'): 3,\n",
       "         ('010', '061'): 1,\n",
       "         ('010', '069'): 1,\n",
       "         ('010', '093'): 2,\n",
       "         ('011', '063'): 2,\n",
       "         ('011', '074'): 3,\n",
       "         ('011', '083'): 1,\n",
       "         ('012', '028'): 1,\n",
       "         ('012', '029'): 1,\n",
       "         ('012', '058'): 4,\n",
       "         ('013', '027'): 2,\n",
       "         ('014', '098'): 3,\n",
       "         ('015', '034'): 2,\n",
       "         ('015', '057'): 4,\n",
       "         ('015', '086'): 1,\n",
       "         ('015', '092'): 3,\n",
       "         ('016', '071'): 1,\n",
       "         ('016', '082'): 1,\n",
       "         ('017', '030'): 3,\n",
       "         ('017', '035'): 4,\n",
       "         ('018', '043'): 1,\n",
       "         ('018', '079'): 8,\n",
       "         ('020', '028'): 1,\n",
       "         ('020', '029'): 1,\n",
       "         ('020', '058'): 4,\n",
       "         ('021', '039'): 2,\n",
       "         ('023', '025'): 2,\n",
       "         ('026', '100'): 15,\n",
       "         ('028', '029'): 3,\n",
       "         ('028', '058'): 1,\n",
       "         ('029', '058'): 1,\n",
       "         ('031', '054'): 2,\n",
       "         ('031', '075'): 1,\n",
       "         ('031', '094'): 2,\n",
       "         ('033', '099'): 1,\n",
       "         ('034', '057'): 6,\n",
       "         ('034', '086'): 3,\n",
       "         ('034', '092'): 2,\n",
       "         ('036', '068'): 7,\n",
       "         ('037', '048'): 2,\n",
       "         ('037', '089'): 1,\n",
       "         ('040', '066'): 4,\n",
       "         ('043', '079'): 3,\n",
       "         ('046', '065'): 2,\n",
       "         ('047', '051'): 4,\n",
       "         ('047', '076'): 2,\n",
       "         ('047', '081'): 2,\n",
       "         ('048', '089'): 5,\n",
       "         ('049', '051'): 3,\n",
       "         ('049', '076'): 2,\n",
       "         ('049', '081'): 3,\n",
       "         ('050', '059'): 3,\n",
       "         ('050', '085'): 1,\n",
       "         ('051', '076'): 7,\n",
       "         ('051', '081'): 1,\n",
       "         ('051', '088'): 3,\n",
       "         ('052', '070'): 1,\n",
       "         ('053', '060'): 3,\n",
       "         ('053', '090'): 1,\n",
       "         ('054', '075'): 3,\n",
       "         ('054', '094'): 1,\n",
       "         ('057', '086'): 1,\n",
       "         ('057', '092'): 1,\n",
       "         ('059', '085'): 4,\n",
       "         ('060', '090'): 2,\n",
       "         ('061', '093'): 16,\n",
       "         ('062', '097'): 2,\n",
       "         ('063', '074'): 3,\n",
       "         ('063', '078'): 2,\n",
       "         ('063', '083'): 1,\n",
       "         ('064', '073'): 1,\n",
       "         ('064', '080'): 2,\n",
       "         ('069', '093'): 11,\n",
       "         ('070', '084'): 1,\n",
       "         ('071', '082'): 1,\n",
       "         ('072', '087'): 2,\n",
       "         ('073', '080'): 4,\n",
       "         ('073', '096'): 4,\n",
       "         ('074', '078'): 1,\n",
       "         ('074', '083'): 2,\n",
       "         ('075', '094'): 1,\n",
       "         ('076', '081'): 2,\n",
       "         ('076', '088'): 1,\n",
       "         ('078', '083'): 1,\n",
       "         ('080', '096'): 2,\n",
       "         ('081', '088'): 4,\n",
       "         ('086', '092'): 2,\n",
       "         ('001', '092'): 1,\n",
       "         ('002', '016'): 3,\n",
       "         ('002', '036'): 5,\n",
       "         ('002', '068'): 11,\n",
       "         ('002', '077'): 2,\n",
       "         ('002', '091'): 3,\n",
       "         ('004', '018'): 5,\n",
       "         ('004', '054'): 5,\n",
       "         ('004', '079'): 4,\n",
       "         ('006', '065'): 2,\n",
       "         ('006', '085'): 3,\n",
       "         ('009', '023'): 4,\n",
       "         ('009', '034'): 4,\n",
       "         ('009', '048'): 5,\n",
       "         ('009', '057'): 8,\n",
       "         ('010', '029'): 3,\n",
       "         ('010', '030'): 2,\n",
       "         ('010', '035'): 2,\n",
       "         ('010', '098'): 1,\n",
       "         ('011', '097'): 8,\n",
       "         ('012', '055'): 9,\n",
       "         ('014', '067'): 1,\n",
       "         ('014', '089'): 3,\n",
       "         ('014', '101'): 3,\n",
       "         ('015', '071'): 2,\n",
       "         ('015', '075'): 3,\n",
       "         ('016', '036'): 5,\n",
       "         ('016', '051'): 6,\n",
       "         ('016', '068'): 4,\n",
       "         ('016', '077'): 1,\n",
       "         ('016', '091'): 2,\n",
       "         ('017', '052'): 6,\n",
       "         ('017', '078'): 9,\n",
       "         ('017', '084'): 6,\n",
       "         ('018', '054'): 8,\n",
       "         ('020', '055'): 9,\n",
       "         ('021', '032'): 4,\n",
       "         ('021', '056'): 6,\n",
       "         ('021', '062'): 6,\n",
       "         ('021', '081'): 3,\n",
       "         ('021', '093'): 5,\n",
       "         ('022', '026'): 1,\n",
       "         ('022', '099'): 2,\n",
       "         ('023', '034'): 9,\n",
       "         ('023', '048'): 14,\n",
       "         ('023', '057'): 7,\n",
       "         ('024', '027'): 2,\n",
       "         ('024', '041'): 16,\n",
       "         ('025', '058'): 4,\n",
       "         ('025', '066'): 3,\n",
       "         ('026', '099'): 2,\n",
       "         ('027', '041'): 2,\n",
       "         ('028', '100'): 1,\n",
       "         ('029', '030'): 1,\n",
       "         ('029', '035'): 2,\n",
       "         ('029', '098'): 1,\n",
       "         ('030', '098'): 2,\n",
       "         ('031', '039'): 8,\n",
       "         ('031', '072'): 2,\n",
       "         ('031', '080'): 1,\n",
       "         ('032', '056'): 7,\n",
       "         ('032', '062'): 3,\n",
       "         ('032', '081'): 3,\n",
       "         ('032', '088'): 2,\n",
       "         ('032', '093'): 1,\n",
       "         ('033', '050'): 5,\n",
       "         ('033', '094'): 4,\n",
       "         ('034', '048'): 10,\n",
       "         ('035', '098'): 1,\n",
       "         ('036', '051'): 6,\n",
       "         ('036', '077'): 3,\n",
       "         ('036', '091'): 8,\n",
       "         ('037', '053'): 5,\n",
       "         ('038', '061'): 4,\n",
       "         ('038', '069'): 5,\n",
       "         ('039', '072'): 1,\n",
       "         ('039', '080'): 2,\n",
       "         ('040', '047'): 16,\n",
       "         ('040', '049'): 20,\n",
       "         ('042', '058'): 3,\n",
       "         ('042', '066'): 2,\n",
       "         ('043', '059'): 11,\n",
       "         ('044', '076'): 12,\n",
       "         ('046', '087'): 1,\n",
       "         ('047', '070'): 6,\n",
       "         ('048', '057'): 11,\n",
       "         ('049', '070'): 5,\n",
       "         ('050', '094'): 1,\n",
       "         ('051', '068'): 9,\n",
       "         ('051', '077'): 2,\n",
       "         ('051', '091'): 3,\n",
       "         ('052', '078'): 3,\n",
       "         ('054', '079'): 10,\n",
       "         ('056', '062'): 3,\n",
       "         ('056', '081'): 3,\n",
       "         ('056', '088'): 2,\n",
       "         ('056', '093'): 3,\n",
       "         ('062', '081'): 3,\n",
       "         ('062', '088'): 4,\n",
       "         ('062', '093'): 1,\n",
       "         ('063', '082'): 9,\n",
       "         ('065', '085'): 8,\n",
       "         ('067', '089'): 5,\n",
       "         ('067', '101'): 5,\n",
       "         ('068', '077'): 3,\n",
       "         ('068', '091'): 3,\n",
       "         ('072', '080'): 4,\n",
       "         ('074', '097'): 2,\n",
       "         ('078', '084'): 3,\n",
       "         ('081', '093'): 5,\n",
       "         ('083', '096'): 5,\n",
       "         ('088', '093'): 3,\n",
       "         ('089', '101'): 6,\n",
       "         ('001', '013'): 1,\n",
       "         ('001', '097'): 2,\n",
       "         ('002', '017'): 1,\n",
       "         ('003', '021'): 1,\n",
       "         ('003', '029'): 2,\n",
       "         ('003', '099'): 1,\n",
       "         ('003', '101'): 1,\n",
       "         ('004', '058'): 2,\n",
       "         ('006', '031'): 14,\n",
       "         ('006', '081'): 3,\n",
       "         ('006', '087'): 4,\n",
       "         ('007', '012'): 1,\n",
       "         ('007', '020'): 1,\n",
       "         ('007', '054'): 3,\n",
       "         ('007', '055'): 4,\n",
       "         ('009', '027'): 2,\n",
       "         ('009', '033'): 3,\n",
       "         ('009', '083'): 1,\n",
       "         ('010', '059'): 1,\n",
       "         ('011', '022'): 2,\n",
       "         ('011', '049'): 1,\n",
       "         ('011', '088'): 2,\n",
       "         ('012', '054'): 2,\n",
       "         ('013', '097'): 1,\n",
       "         ('014', '024'): 2,\n",
       "         ('014', '040'): 13,\n",
       "         ('016', '045'): 2,\n",
       "         ('016', '086'): 1,\n",
       "         ('016', '100'): 1,\n",
       "         ('019', '090'): 1,\n",
       "         ('020', '054'): 2,\n",
       "         ('021', '029'): 2,\n",
       "         ('021', '099'): 2,\n",
       "         ('021', '101'): 1,\n",
       "         ('022', '049'): 2,\n",
       "         ('022', '088'): 1,\n",
       "         ('023', '091'): 1,\n",
       "         ('024', '040'): 2,\n",
       "         ('025', '037'): 1,\n",
       "         ('025', '060'): 1,\n",
       "         ('025', '071'): 3,\n",
       "         ('026', '092'): 2,\n",
       "         ('027', '033'): 1,\n",
       "         ('027', '083'): 1,\n",
       "         ('029', '099'): 2,\n",
       "         ('029', '101'): 2,\n",
       "         ('030', '091'): 2,\n",
       "         ('031', '081'): 2,\n",
       "         ('031', '087'): 3,\n",
       "         ('033', '083'): 1,\n",
       "         ('034', '064'): 2,\n",
       "         ('035', '091'): 3,\n",
       "         ('037', '071'): 1,\n",
       "         ('042', '047'): 1,\n",
       "         ('042', '061'): 1,\n",
       "         ('042', '069'): 1,\n",
       "         ('042', '076'): 1,\n",
       "         ('042', '093'): 1,\n",
       "         ('043', '080'): 1,\n",
       "         ('044', '063'): 2,\n",
       "         ('044', '085'): 1,\n",
       "         ('044', '096'): 3,\n",
       "         ('045', '086'): 2,\n",
       "         ('045', '100'): 4,\n",
       "         ('046', '048'): 2,\n",
       "         ('046', '066'): 2,\n",
       "         ('047', '061'): 4,\n",
       "         ('047', '069'): 5,\n",
       "         ('047', '093'): 5,\n",
       "         ('048', '066'): 5,\n",
       "         ('050', '053'): 3,\n",
       "         ('052', '065'): 2,\n",
       "         ('052', '072'): 2,\n",
       "         ('054', '055'): 1,\n",
       "         ('056', '067'): 2,\n",
       "         ('057', '082'): 11,\n",
       "         ('058', '079'): 1,\n",
       "         ('060', '071'): 2,\n",
       "         ('061', '076'): 1,\n",
       "         ('063', '085'): 1,\n",
       "         ('063', '096'): 1,\n",
       "         ('065', '072'): 2,\n",
       "         ('065', '084'): 2,\n",
       "         ('069', '076'): 3,\n",
       "         ('070', '075'): 2,\n",
       "         ('070', '089'): 3,\n",
       "         ('072', '084'): 2,\n",
       "         ('075', '089'): 7,\n",
       "         ('076', '093'): 1,\n",
       "         ('081', '087'): 3,\n",
       "         ('085', '096'): 1,\n",
       "         ('086', '100'): 1,\n",
       "         ('099', '101'): 3,\n",
       "         ('001', '023'): 2,\n",
       "         ('001', '040'): 2,\n",
       "         ('001', '057'): 1,\n",
       "         ('002', '029'): 6,\n",
       "         ('003', '018'): 3,\n",
       "         ('004', '014'): 2,\n",
       "         ('004', '027'): 2,\n",
       "         ('004', '055'): 1,\n",
       "         ('005', '012'): 2,\n",
       "         ('005', '020'): 2,\n",
       "         ('005', '024'): 1,\n",
       "         ('005', '034'): 2,\n",
       "         ('005', '041'): 3,\n",
       "         ('005', '047'): 1,\n",
       "         ('005', '049'): 1,\n",
       "         ('005', '058'): 3,\n",
       "         ('005', '066'): 1,\n",
       "         ('005', '072'): 2,\n",
       "         ('005', '088'): 3,\n",
       "         ('006', '039'): 9,\n",
       "         ('006', '100'): 1,\n",
       "         ('007', '022'): 1,\n",
       "         ('007', '056'): 9,\n",
       "         ('009', '091'): 3,\n",
       "         ('010', '073'): 1,\n",
       "         ('012', '024'): 1,\n",
       "         ('012', '034'): 1,\n",
       "         ('012', '041'): 1,\n",
       "         ('012', '047'): 6,\n",
       "         ('012', '049'): 4,\n",
       "         ('012', '066'): 3,\n",
       "         ('012', '072'): 4,\n",
       "         ('012', '080'): 4,\n",
       "         ('012', '088'): 7,\n",
       "         ('014', '027'): 2,\n",
       "         ('014', '055'): 3,\n",
       "         ('016', '085'): 1,\n",
       "         ('016', '101'): 1,\n",
       "         ('017', '044'): 1,\n",
       "         ('017', '063'): 2,\n",
       "         ('017', '095'): 2,\n",
       "         ('019', '069'): 5,\n",
       "         ('020', '024'): 1,\n",
       "         ('020', '034'): 1,\n",
       "         ('020', '041'): 1,\n",
       "         ('020', '047'): 6,\n",
       "         ('020', '049'): 4,\n",
       "         ('020', '066'): 3,\n",
       "         ('020', '072'): 4,\n",
       "         ('020', '080'): 4,\n",
       "         ('020', '088'): 7,\n",
       "         ('021', '059'): 2,\n",
       "         ('022', '056'): 3,\n",
       "         ('023', '038'): 14,\n",
       "         ('023', '040'): 11,\n",
       "         ('024', '034'): 2,\n",
       "         ('024', '047'): 2,\n",
       "         ('024', '049'): 4,\n",
       "         ('024', '058'): 3,\n",
       "         ('024', '066'): 5,\n",
       "         ('024', '080'): 2,\n",
       "         ('024', '088'): 1,\n",
       "         ('026', '075'): 4,\n",
       "         ('026', '086'): 2,\n",
       "         ('027', '055'): 3,\n",
       "         ('029', '076'): 6,\n",
       "         ('029', '081'): 3,\n",
       "         ('030', '036'): 2,\n",
       "         ('031', '032'): 1,\n",
       "         ('033', '067'): 2,\n",
       "         ('034', '041'): 2,\n",
       "         ('034', '047'): 5,\n",
       "         ('034', '049'): 8,\n",
       "         ('034', '058'): 3,\n",
       "         ('034', '066'): 4,\n",
       "         ('034', '072'): 3,\n",
       "         ('034', '080'): 2,\n",
       "         ('034', '088'): 3,\n",
       "         ('035', '036'): 2,\n",
       "         ('038', '040'): 1,\n",
       "         ('038', '057'): 2,\n",
       "         ('039', '100'): 1,\n",
       "         ('041', '047'): 2,\n",
       "         ('041', '049'): 2,\n",
       "         ('041', '058'): 4,\n",
       "         ('041', '066'): 4,\n",
       "         ('041', '072'): 3,\n",
       "         ('041', '080'): 2,\n",
       "         ('041', '088'): 1,\n",
       "         ('042', '046'): 2,\n",
       "         ('042', '097'): 3,\n",
       "         ('043', '052'): 2,\n",
       "         ('043', '084'): 2,\n",
       "         ('044', '095'): 2,\n",
       "         ('045', '079'): 1,\n",
       "         ('046', '097'): 2,\n",
       "         ('047', '058'): 7,\n",
       "         ('047', '066'): 5,\n",
       "         ('047', '072'): 1,\n",
       "         ('047', '080'): 8,\n",
       "         ('049', '058'): 8,\n",
       "         ('049', '066'): 7,\n",
       "         ('049', '072'): 1,\n",
       "         ('049', '080'): 3,\n",
       "         ('050', '077'): 2,\n",
       "         ('050', '089'): 3,\n",
       "         ('051', '053'): 1,\n",
       "         ('051', '092'): 2,\n",
       "         ('053', '092'): 7,\n",
       "         ('054', '082'): 2,\n",
       "         ('054', '099'): 1,\n",
       "         ('058', '072'): 8,\n",
       "         ('058', '080'): 1,\n",
       "         ('058', '088'): 8,\n",
       "         ('059', '062'): 1,\n",
       "         ('060', '079'): 1,\n",
       "         ('063', '095'): 6,\n",
       "         ('064', '083'): 7,\n",
       "         ('065', '071'): 3,\n",
       "         ('066', '072'): 6,\n",
       "         ('066', '080'): 2,\n",
       "         ('066', '088'): 8,\n",
       "         ('068', '070'): 2,\n",
       "         ('072', '088'): 2,\n",
       "         ('075', '086'): 1,\n",
       "         ('077', '089'): 1,\n",
       "         ('078', '087'): 3,\n",
       "         ('080', '088'): 3,\n",
       "         ('082', '099'): 2,\n",
       "         ('085', '101'): 3,\n",
       "         ('001', '007'): 1,\n",
       "         ('001', '025'): 2,\n",
       "         ('001', '061'): 2,\n",
       "         ('001', '065'): 1,\n",
       "         ('001', '071'): 1,\n",
       "         ('001', '073'): 1,\n",
       "         ('002', '028'): 4,\n",
       "         ('002', '090'): 5,\n",
       "         ('003', '042'): 1,\n",
       "         ('007', '025'): 2,\n",
       "         ('007', '061'): 4,\n",
       "         ('007', '065'): 2,\n",
       "         ('007', '071'): 2,\n",
       "         ('007', '073'): 2,\n",
       "         ('007', '097'): 2,\n",
       "         ('008', '021'): 5,\n",
       "         ('008', '033'): 6,\n",
       "         ('008', '094'): 7,\n",
       "         ('010', '095'): 2,\n",
       "         ('011', '015'): 2,\n",
       "         ('011', '058'): 3,\n",
       "         ('012', '099'): 2,\n",
       "         ('014', '030'): 3,\n",
       "         ('014', '035'): 2,\n",
       "         ('014', '043'): 7,\n",
       "         ('014', '050'): 3,\n",
       "         ('014', '059'): 2,\n",
       "         ('014', '069'): 2,\n",
       "         ('014', '072'): 2,\n",
       "         ('014', '075'): 4,\n",
       "         ('014', '076'): 2,\n",
       "         ('015', '058'): 3,\n",
       "         ('016', '089'): 3,\n",
       "         ('018', '056'): 1,\n",
       "         ('018', '063'): 3,\n",
       "         ('020', '099'): 2,\n",
       "         ('021', '033'): 1,\n",
       "         ('021', '082'): 2,\n",
       "         ('021', '094'): 1,\n",
       "         ('022', '040'): 4,\n",
       "         ('022', '057'): 9,\n",
       "         ('022', '068'): 2,\n",
       "         ('022', '079'): 1,\n",
       "         ('022', '081'): 3,\n",
       "         ('023', '026'): 1,\n",
       "         ('023', '067'): 1,\n",
       "         ('024', '087'): 2,\n",
       "         ('025', '061'): 2,\n",
       "         ('025', '065'): 2,\n",
       "         ('025', '073'): 8,\n",
       "         ('025', '097'): 1,\n",
       "         ('026', '067'): 4,\n",
       "         ('027', '101'): 19,\n",
       "         ('030', '043'): 3,\n",
       "         ('030', '050'): 3,\n",
       "         ('030', '059'): 6,\n",
       "         ('030', '069'): 3,\n",
       "         ('030', '072'): 2,\n",
       "         ('030', '075'): 4,\n",
       "         ('030', '076'): 2,\n",
       "         ('032', '052'): 1,\n",
       "         ('032', '084'): 1,\n",
       "         ('033', '082'): 10,\n",
       "         ('034', '100'): 1,\n",
       "         ('035', '043'): 1,\n",
       "         ('035', '050'): 2,\n",
       "         ('035', '059'): 4,\n",
       "         ('035', '069'): 4,\n",
       "         ('035', '072'): 3,\n",
       "         ('035', '075'): 3,\n",
       "         ('035', '076'): 1,\n",
       "         ('037', '041'): 1,\n",
       "         ('038', '086'): 4,\n",
       "         ('040', '068'): 2,\n",
       "         ('040', '079'): 2,\n",
       "         ('040', '081'): 2,\n",
       "         ('043', '050'): 5,\n",
       "         ('043', '069'): 2,\n",
       "         ('043', '072'): 1,\n",
       "         ('043', '075'): 9,\n",
       "         ('043', '076'): 3,\n",
       "         ('046', '055'): 1,\n",
       "         ('047', '048'): 14,\n",
       "         ('047', '062'): 2,\n",
       "         ('048', '049'): 18,\n",
       "         ('048', '051'): 3,\n",
       "         ('048', '062'): 1,\n",
       "         ('048', '080'): 1,\n",
       "         ('048', '088'): 2,\n",
       "         ('049', '062'): 2,\n",
       "         ('050', '069'): 1,\n",
       "         ('050', '072'): 3,\n",
       "         ('050', '075'): 5,\n",
       "         ('050', '076'): 3,\n",
       "         ('051', '062'): 1,\n",
       "         ('051', '080'): 2,\n",
       "         ('053', '098'): 2,\n",
       "         ('056', '063'): 2,\n",
       "         ('057', '068'): 2,\n",
       "         ('057', '079'): 3,\n",
       "         ('057', '081'): 1,\n",
       "         ('059', '069'): 1,\n",
       "         ('059', '072'): 1,\n",
       "         ('059', '075'): 7,\n",
       "         ('059', '076'): 3,\n",
       "         ('061', '065'): 1,\n",
       "         ('061', '071'): 4,\n",
       "         ('061', '073'): 1,\n",
       "         ('061', '097'): 1,\n",
       "         ('062', '080'): 2,\n",
       "         ('065', '073'): 3,\n",
       "         ('065', '097'): 13,\n",
       "         ('066', '092'): 2,\n",
       "         ('068', '079'): 1,\n",
       "         ('068', '081'): 2,\n",
       "         ('069', '072'): 1,\n",
       "         ('069', '075'): 2,\n",
       "         ('071', '073'): 3,\n",
       "         ('071', '097'): 6,\n",
       "         ('072', '075'): 2,\n",
       "         ('072', '076'): 2,\n",
       "         ('073', '097'): 3,\n",
       "         ('075', '076'): 1,\n",
       "         ('077', '078'): 3,\n",
       "         ('082', '094'): 1,\n",
       "         ('093', '095'): 1,\n",
       "         ('001', '018'): 1,\n",
       "         ('002', '010'): 1,\n",
       "         ('002', '052'): 1,\n",
       "         ('002', '056'): 1,\n",
       "         ('002', '084'): 1,\n",
       "         ('003', '016'): 1,\n",
       "         ('003', '097'): 3,\n",
       "         ('004', '009'): 1,\n",
       "         ('004', '059'): 1,\n",
       "         ('004', '060'): 2,\n",
       "         ('004', '064'): 2,\n",
       "         ('004', '074'): 3,\n",
       "         ('005', '082'): 2,\n",
       "         ('006', '027'): 1,\n",
       "         ('006', '055'): 8,\n",
       "         ('007', '072'): 2,\n",
       "         ('009', '059'): 3,\n",
       "         ('009', '060'): 1,\n",
       "         ('009', '074'): 2,\n",
       "         ('010', '052'): 4,\n",
       "         ('010', '056'): 1,\n",
       "         ('010', '084'): 4,\n",
       "         ('010', '090'): 3,\n",
       "         ('011', '065'): 3,\n",
       "         ('012', '061'): 3,\n",
       "         ('013', '035'): 3,\n",
       "         ('014', '019'): 2,\n",
       "         ('014', '070'): 1,\n",
       "         ('015', '053'): 3,\n",
       "         ('016', '097'): 1,\n",
       "         ('017', '025'): 2,\n",
       "         ('017', '042'): 4,\n",
       "         ('017', '045'): 9,\n",
       "         ('017', '050'): 2,\n",
       "         ('019', '040'): 2,\n",
       "         ('019', '043'): 2,\n",
       "         ('019', '070'): 3,\n",
       "         ('019', '101'): 1,\n",
       "         ('020', '061'): 3,\n",
       "         ('021', '077'): 1,\n",
       "         ('021', '083'): 1,\n",
       "         ('022', '030'): 1,\n",
       "         ('023', '047'): 17,\n",
       "         ('023', '049'): 10,\n",
       "         ('023', '073'): 1,\n",
       "         ('023', '092'): 2,\n",
       "         ('023', '096'): 1,\n",
       "         ('023', '099'): 1,\n",
       "         ('024', '033'): 2,\n",
       "         ('024', '068'): 1,\n",
       "         ('024', '081'): 2,\n",
       "         ('025', '045'): 1,\n",
       "         ('025', '050'): 2,\n",
       "         ('027', '031'): 2,\n",
       "         ('028', '046'): 1,\n",
       "         ('028', '054'): 1,\n",
       "         ('031', '055'): 11,\n",
       "         ('033', '068'): 1,\n",
       "         ('033', '081'): 3,\n",
       "         ('034', '078'): 2,\n",
       "         ('036', '063'): 4,\n",
       "         ('036', '067'): 2,\n",
       "         ('037', '085'): 2,\n",
       "         ('038', '062'): 2,\n",
       "         ('038', '071'): 2,\n",
       "         ('039', '066'): 1,\n",
       "         ('039', '088'): 2,\n",
       "         ('040', '043'): 4,\n",
       "         ('040', '069'): 1,\n",
       "         ('040', '101'): 1,\n",
       "         ('041', '082'): 1,\n",
       "         ('042', '045'): 2,\n",
       "         ('042', '050'): 1,\n",
       "         ('043', '070'): 2,\n",
       "         ('043', '101'): 5,\n",
       "         ('044', '087'): 2,\n",
       "         ('044', '093'): 1,\n",
       "         ('045', '050'): 2,\n",
       "         ('046', '054'): 3,\n",
       "         ('047', '073'): 2,\n",
       "         ('047', '092'): 2,\n",
       "         ('047', '096'): 1,\n",
       "         ('047', '099'): 2,\n",
       "         ('048', '073'): 3,\n",
       "         ('048', '092'): 2,\n",
       "         ('048', '096'): 2,\n",
       "         ('048', '099'): 2,\n",
       "         ('049', '073'): 4,\n",
       "         ('049', '092'): 3,\n",
       "         ('049', '096'): 1,\n",
       "         ('049', '099'): 2,\n",
       "         ('051', '089'): 2,\n",
       "         ('052', '056'): 2,\n",
       "         ('052', '090'): 2,\n",
       "         ('053', '057'): 1,\n",
       "         ('056', '084'): 2,\n",
       "         ('056', '090'): 1,\n",
       "         ('058', '082'): 1,\n",
       "         ('059', '060'): 1,\n",
       "         ('059', '064'): 1,\n",
       "         ('059', '074'): 3,\n",
       "         ('060', '064'): 3,\n",
       "         ('060', '074'): 2,\n",
       "         ('062', '071'): 2,\n",
       "         ('064', '074'): 2,\n",
       "         ('069', '070'): 1,\n",
       "         ('069', '101'): 1,\n",
       "         ('070', '101'): 1,\n",
       "         ('073', '099'): 8,\n",
       "         ('076', '098'): 2,\n",
       "         ('077', '083'): 2,\n",
       "         ('084', '090'): 2,\n",
       "         ('087', '093'): 3,\n",
       "         ('092', '096'): 1,\n",
       "         ('092', '099'): 1,\n",
       "         ('094', '095'): 2,\n",
       "         ('096', '099'): 1,\n",
       "         ('001', '043'): 1,\n",
       "         ('002', '053'): 2,\n",
       "         ('002', '065'): 2,\n",
       "         ('004', '025'): 2,\n",
       "         ('004', '071'): 1,\n",
       "         ('004', '073'): 2,\n",
       "         ('005', '013'): 2,\n",
       "         ('006', '044'): 1,\n",
       "         ('007', '021'): 5,\n",
       "         ('007', '030'): 3,\n",
       "         ('007', '032'): 9,\n",
       "         ('007', '035'): 2,\n",
       "         ('007', '081'): 3,\n",
       "         ('008', '017'): 2,\n",
       "         ('008', '085'): 1,\n",
       "         ('009', '015'): 2,\n",
       "         ('009', '070'): 12,\n",
       "         ('009', '095'): 4,\n",
       "         ('010', '094'): 3,\n",
       "         ('011', '072'): 5,\n",
       "         ('011', '086'): 11,\n",
       "         ('014', '045'): 1,\n",
       "         ('014', '060'): 4,\n",
       "         ('014', '078'): 1,\n",
       "         ('014', '091'): 2,\n",
       "         ('015', '070'): 1,\n",
       "         ('015', '095'): 2,\n",
       "         ('016', '033'): 2,\n",
       "         ('016', '064'): 2,\n",
       "         ('016', '076'): 15,\n",
       "         ('017', '085'): 1,\n",
       "         ('019', '088'): 2,\n",
       "         ('021', '030'): 1,\n",
       "         ('021', '035'): 2,\n",
       "         ('021', '061'): 3,\n",
       "         ('022', '101'): 2,\n",
       "         ('023', '058'): 5,\n",
       "         ('023', '062'): 1,\n",
       "         ('024', '074'): 3,\n",
       "         ('025', '029'): 5,\n",
       "         ('026', '083'): 3,\n",
       "         ('026', '087'): 3,\n",
       "         ('029', '071'): 2,\n",
       "         ('029', '073'): 3,\n",
       "         ('030', '032'): 1,\n",
       "         ('030', '056'): 1,\n",
       "         ('030', '061'): 4,\n",
       "         ('030', '081'): 2,\n",
       "         ('032', '035'): 1,\n",
       "         ('032', '061'): 3,\n",
       "         ('033', '064'): 2,\n",
       "         ('033', '076'): 2,\n",
       "         ('034', '037'): 1,\n",
       "         ('034', '096'): 2,\n",
       "         ('035', '056'): 1,\n",
       "         ('035', '061'): 2,\n",
       "         ('035', '081'): 2,\n",
       "         ('036', '100'): 2,\n",
       "         ('037', '066'): 2,\n",
       "         ('037', '096'): 1,\n",
       "         ('038', '047'): 6,\n",
       "         ('038', '049'): 2,\n",
       "         ('038', '058'): 7,\n",
       "         ('038', '092'): 3,\n",
       "         ('045', '078'): 6,\n",
       "         ('051', '100'): 1,\n",
       "         ('053', '065'): 1,\n",
       "         ('055', '079'): 3,\n",
       "         ('055', '090'): 2,\n",
       "         ('056', '061'): 1,\n",
       "         ('057', '095'): 3,\n",
       "         ('058', '062'): 1,\n",
       "         ('058', '092'): 2,\n",
       "         ('059', '068'): 6,\n",
       "         ('060', '078'): 5,\n",
       "         ('061', '081'): 3,\n",
       "         ('062', '092'): 4,\n",
       "         ('063', '093'): 1,\n",
       "         ('064', '076'): 1,\n",
       "         ('066', '096'): 1,\n",
       "         ('070', '095'): 6,\n",
       "         ('072', '086'): 6,\n",
       "         ('072', '097'): 2,\n",
       "         ('078', '091'): 3,\n",
       "         ('079', '090'): 1,\n",
       "         ('083', '087'): 1,\n",
       "         ('086', '097'): 6,\n",
       "         ('001', '044'): 7,\n",
       "         ('001', '059'): 3,\n",
       "         ('001', '090'): 6,\n",
       "         ('003', '052'): 4,\n",
       "         ('003', '084'): 4,\n",
       "         ('006', '033'): 2,\n",
       "         ('007', '053'): 2,\n",
       "         ('008', '088'): 2,\n",
       "         ('010', '018'): 1,\n",
       "         ('011', '071'): 2,\n",
       "         ('012', '017'): 3,\n",
       "         ('012', '030'): 4,\n",
       "         ('012', '035'): 2,\n",
       "         ('012', '051'): 4,\n",
       "         ('012', '068'): 1,\n",
       "         ('013', '093'): 1,\n",
       "         ('013', '099'): 9,\n",
       "         ('014', '066'): 6,\n",
       "         ('014', '086'): 1,\n",
       "         ('016', '024'): 2,\n",
       "         ('017', '020'): 3,\n",
       "         ('017', '051'): 2,\n",
       "         ('017', '068'): 1,\n",
       "         ('020', '030'): 4,\n",
       "         ('020', '035'): 2,\n",
       "         ('020', '051'): 4,\n",
       "         ('020', '068'): 1,\n",
       "         ('021', '026'): 2,\n",
       "         ('021', '075'): 1,\n",
       "         ('021', '092'): 1,\n",
       "         ('021', '100'): 1,\n",
       "         ('022', '025'): 3,\n",
       "         ('022', '036'): 1,\n",
       "         ('022', '063'): 7,\n",
       "         ('022', '094'): 6,\n",
       "         ('024', '076'): 2,\n",
       "         ('025', '036'): 2,\n",
       "         ('025', '081'): 2,\n",
       "         ('025', '094'): 1,\n",
       "         ('027', '067'): 5,\n",
       "         ('028', '044'): 3,\n",
       "         ('029', '032'): 1,\n",
       "         ('029', '061'): 1,\n",
       "         ('029', '069'): 1,\n",
       "         ('030', '068'): 3,\n",
       "         ('031', '033'): 1,\n",
       "         ('031', '042'): 1,\n",
       "         ('031', '085'): 3,\n",
       "         ('032', '069'): 1,\n",
       "         ('033', '042'): 2,\n",
       "         ('033', '055'): 1,\n",
       "         ('033', '085'): 1,\n",
       "         ('034', '040'): 11,\n",
       "         ('034', '089'): 1,\n",
       "         ('035', '068'): 2,\n",
       "         ('036', '081'): 2,\n",
       "         ('036', '094'): 1,\n",
       "         ('037', '078'): 9,\n",
       "         ('037', '080'): 1,\n",
       "         ('040', '048'): 15,\n",
       "         ('040', '089'): 3,\n",
       "         ('042', '055'): 1,\n",
       "         ('042', '085'): 1,\n",
       "         ('044', '059'): 5,\n",
       "         ('044', '090'): 3,\n",
       "         ('045', '052'): 5,\n",
       "         ('045', '084'): 5,\n",
       "         ('046', '056'): 1,\n",
       "         ('046', '073'): 2,\n",
       "         ('049', '089'): 3,\n",
       "         ('052', '091'): 6,\n",
       "         ('055', '085'): 2,\n",
       "         ('057', '096'): 1,\n",
       "         ('060', '066'): 2,\n",
       "         ('060', '072'): 1,\n",
       "         ('060', '086'): 1,\n",
       "         ('063', '081'): 1,\n",
       "         ('063', '094'): 5,\n",
       "         ('065', '074'): 3,\n",
       "         ('066', '086'): 1,\n",
       "         ('070', '096'): 2,\n",
       "         ('075', '092'): 1,\n",
       "         ('075', '100'): 3,\n",
       "         ('077', '079'): 1,\n",
       "         ('078', '080'): 1,\n",
       "         ('081', '094'): 2,\n",
       "         ('082', '083'): 1,\n",
       "         ('084', '091'): 6,\n",
       "         ('087', '098'): 4,\n",
       "         ('092', '100'): 3,\n",
       "         ('093', '099'): 1,\n",
       "         ('001', '030'): 2,\n",
       "         ('001', '035'): 2,\n",
       "         ('001', '051'): 4,\n",
       "         ('002', '055'): 2,\n",
       "         ('003', '082'): 1,\n",
       "         ('004', '026'): 1,\n",
       "         ('004', '096'): 2,\n",
       "         ...})"
      ]
     },
     "execution_count": 313,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Count"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 4.算出Similarity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 331,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 去除掉被少於2個band認為是相似的pair(也就是只有一個band認為他們是相似的)->candidate pair\n",
    "Ultimate_candidate = dict([(k,v) for k, v in filter(lambda x: x[1]>=2, list(Count.items()))])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 333,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 將每個candidate pair被認為是相似的數量 除以 50 就是 Similarity\n",
    "Similarity = [(k,v/50) for k,v in Ultimate_candidate.items()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 334,
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(('001', '016'), 0.04),\n",
       " (('001', '038'), 0.04),\n",
       " (('003', '037'), 0.3),\n",
       " (('003', '045'), 0.16),\n",
       " (('003', '060'), 0.12),\n",
       " (('003', '077'), 0.04),\n",
       " (('003', '091'), 0.12),\n",
       " (('004', '029'), 0.06),\n",
       " (('004', '083'), 0.06),\n",
       " (('005', '019'), 0.1),\n",
       " (('005', '080'), 0.16),\n",
       " (('006', '025'), 0.04),\n",
       " (('006', '032'), 0.06),\n",
       " (('006', '042'), 0.04),\n",
       " (('006', '063'), 0.04),\n",
       " (('006', '067'), 0.04),\n",
       " (('008', '062'), 0.14),\n",
       " (('008', '082'), 0.1),\n",
       " (('011', '078'), 0.04),\n",
       " (('012', '020'), 1.0),\n",
       " (('015', '087'), 0.04),\n",
       " (('016', '017'), 0.04),\n",
       " (('016', '038'), 0.04),\n",
       " (('019', '065'), 0.06),\n",
       " (('019', '080'), 0.06),\n",
       " (('021', '049'), 0.04),\n",
       " (('021', '088'), 0.08),\n",
       " (('023', '030'), 0.14),\n",
       " (('023', '035'), 0.16),\n",
       " (('023', '051'), 0.08),\n",
       " (('024', '072'), 0.08),\n",
       " (('025', '042'), 0.28),\n",
       " (('025', '063'), 0.06),\n",
       " (('025', '067'), 0.04),\n",
       " (('025', '099'), 0.14),\n",
       " (('026', '028'), 0.04),\n",
       " (('026', '059'), 0.04),\n",
       " (('028', '059'), 0.14),\n",
       " (('028', '090'), 0.38),\n",
       " (('029', '100'), 0.04),\n",
       " (('030', '035'), 0.58),\n",
       " (('030', '051'), 0.08),\n",
       " (('032', '067'), 0.06),\n",
       " (('033', '040'), 0.1),\n",
       " (('033', '057'), 0.08),\n",
       " (('033', '070'), 0.14),\n",
       " (('034', '036'), 0.04),\n",
       " (('035', '051'), 0.08),\n",
       " (('037', '045'), 0.14),\n",
       " (('037', '060'), 0.14),\n",
       " (('037', '077'), 0.04),\n",
       " (('037', '091'), 0.06),\n",
       " (('040', '057'), 0.3),\n",
       " (('040', '070'), 0.24),\n",
       " (('042', '063'), 0.04),\n",
       " (('042', '067'), 0.04),\n",
       " (('042', '099'), 0.1),\n",
       " (('044', '045'), 0.06),\n",
       " (('044', '060'), 0.04),\n",
       " (('044', '091'), 0.04),\n",
       " (('045', '060'), 0.24),\n",
       " (('045', '077'), 0.12),\n",
       " (('045', '091'), 0.46),\n",
       " (('047', '049'), 0.76),\n",
       " (('047', '088'), 0.22),\n",
       " (('049', '088'), 0.3),\n",
       " (('050', '101'), 0.06),\n",
       " (('052', '084'), 1.0),\n",
       " (('053', '075'), 0.04),\n",
       " (('054', '093'), 0.08),\n",
       " (('056', '073'), 0.06),\n",
       " (('057', '070'), 0.34),\n",
       " (('058', '066'), 0.26),\n",
       " (('059', '090'), 0.14),\n",
       " (('060', '077'), 0.04),\n",
       " (('060', '091'), 0.14),\n",
       " (('061', '069'), 0.4),\n",
       " (('061', '094'), 0.04),\n",
       " (('061', '098'), 0.06),\n",
       " (('063', '067'), 0.08),\n",
       " (('063', '099'), 0.04),\n",
       " (('064', '096'), 0.24),\n",
       " (('065', '080'), 0.04),\n",
       " (('067', '099'), 0.04),\n",
       " (('068', '071'), 0.06),\n",
       " (('068', '075'), 0.1),\n",
       " (('069', '094'), 0.04),\n",
       " (('069', '098'), 0.04),\n",
       " (('071', '075'), 0.06),\n",
       " (('073', '092'), 0.04),\n",
       " (('074', '087'), 0.06),\n",
       " (('077', '091'), 0.14),\n",
       " (('079', '081'), 0.16),\n",
       " (('083', '100'), 0.04),\n",
       " (('094', '098'), 0.06),\n",
       " (('001', '012'), 0.04),\n",
       " (('001', '020'), 0.04),\n",
       " (('001', '028'), 0.12),\n",
       " (('001', '058'), 0.08),\n",
       " (('002', '047'), 0.06),\n",
       " (('002', '049'), 0.04),\n",
       " (('002', '051'), 0.12),\n",
       " (('002', '076'), 0.12),\n",
       " (('002', '081'), 0.04),\n",
       " (('003', '046'), 0.18),\n",
       " (('003', '065'), 0.04),\n",
       " (('004', '052'), 0.04),\n",
       " (('004', '084'), 0.04),\n",
       " (('005', '036'), 0.04),\n",
       " (('009', '064'), 0.1),\n",
       " (('009', '096'), 0.06),\n",
       " (('010', '093'), 0.04),\n",
       " (('011', '063'), 0.04),\n",
       " (('011', '074'), 0.06),\n",
       " (('012', '058'), 0.08),\n",
       " (('013', '027'), 0.04),\n",
       " (('014', '098'), 0.06),\n",
       " (('015', '034'), 0.04),\n",
       " (('015', '057'), 0.08),\n",
       " (('015', '092'), 0.06),\n",
       " (('017', '030'), 0.06),\n",
       " (('017', '035'), 0.08),\n",
       " (('018', '079'), 0.16),\n",
       " (('020', '058'), 0.08),\n",
       " (('021', '039'), 0.04),\n",
       " (('023', '025'), 0.04),\n",
       " (('026', '100'), 0.3),\n",
       " (('028', '029'), 0.06),\n",
       " (('031', '054'), 0.04),\n",
       " (('031', '094'), 0.04),\n",
       " (('034', '057'), 0.12),\n",
       " (('034', '086'), 0.06),\n",
       " (('034', '092'), 0.04),\n",
       " (('036', '068'), 0.14),\n",
       " (('037', '048'), 0.04),\n",
       " (('040', '066'), 0.08),\n",
       " (('043', '079'), 0.06),\n",
       " (('046', '065'), 0.04),\n",
       " (('047', '051'), 0.08),\n",
       " (('047', '076'), 0.04),\n",
       " (('047', '081'), 0.04),\n",
       " (('048', '089'), 0.1),\n",
       " (('049', '051'), 0.06),\n",
       " (('049', '076'), 0.04),\n",
       " (('049', '081'), 0.06),\n",
       " (('050', '059'), 0.06),\n",
       " (('051', '076'), 0.14),\n",
       " (('051', '088'), 0.06),\n",
       " (('053', '060'), 0.06),\n",
       " (('054', '075'), 0.06),\n",
       " (('059', '085'), 0.08),\n",
       " (('060', '090'), 0.04),\n",
       " (('061', '093'), 0.32),\n",
       " (('062', '097'), 0.04),\n",
       " (('063', '074'), 0.06),\n",
       " (('063', '078'), 0.04),\n",
       " (('064', '080'), 0.04),\n",
       " (('069', '093'), 0.22),\n",
       " (('072', '087'), 0.04),\n",
       " (('073', '080'), 0.08),\n",
       " (('073', '096'), 0.08),\n",
       " (('074', '083'), 0.04),\n",
       " (('076', '081'), 0.04),\n",
       " (('080', '096'), 0.04),\n",
       " (('081', '088'), 0.08),\n",
       " (('086', '092'), 0.04),\n",
       " (('002', '016'), 0.06),\n",
       " (('002', '036'), 0.1),\n",
       " (('002', '068'), 0.22),\n",
       " (('002', '077'), 0.04),\n",
       " (('002', '091'), 0.06),\n",
       " (('004', '018'), 0.1),\n",
       " (('004', '054'), 0.1),\n",
       " (('004', '079'), 0.08),\n",
       " (('006', '065'), 0.04),\n",
       " (('006', '085'), 0.06),\n",
       " (('009', '023'), 0.08),\n",
       " (('009', '034'), 0.08),\n",
       " (('009', '048'), 0.1),\n",
       " (('009', '057'), 0.16),\n",
       " (('010', '029'), 0.06),\n",
       " (('010', '030'), 0.04),\n",
       " (('010', '035'), 0.04),\n",
       " (('011', '097'), 0.16),\n",
       " (('012', '055'), 0.18),\n",
       " (('014', '089'), 0.06),\n",
       " (('014', '101'), 0.06),\n",
       " (('015', '071'), 0.04),\n",
       " (('015', '075'), 0.06),\n",
       " (('016', '036'), 0.1),\n",
       " (('016', '051'), 0.12),\n",
       " (('016', '068'), 0.08),\n",
       " (('016', '091'), 0.04),\n",
       " (('017', '052'), 0.12),\n",
       " (('017', '078'), 0.18),\n",
       " (('017', '084'), 0.12),\n",
       " (('018', '054'), 0.16),\n",
       " (('020', '055'), 0.18),\n",
       " (('021', '032'), 0.08),\n",
       " (('021', '056'), 0.12),\n",
       " (('021', '062'), 0.12),\n",
       " (('021', '081'), 0.06),\n",
       " (('021', '093'), 0.1),\n",
       " (('022', '099'), 0.04),\n",
       " (('023', '034'), 0.18),\n",
       " (('023', '048'), 0.28),\n",
       " (('023', '057'), 0.14),\n",
       " (('024', '027'), 0.04),\n",
       " (('024', '041'), 0.32),\n",
       " (('025', '058'), 0.08),\n",
       " (('025', '066'), 0.06),\n",
       " (('026', '099'), 0.04),\n",
       " (('027', '041'), 0.04),\n",
       " (('029', '035'), 0.04),\n",
       " (('030', '098'), 0.04),\n",
       " (('031', '039'), 0.16),\n",
       " (('031', '072'), 0.04),\n",
       " (('032', '056'), 0.14),\n",
       " (('032', '062'), 0.06),\n",
       " (('032', '081'), 0.06),\n",
       " (('032', '088'), 0.04),\n",
       " (('033', '050'), 0.1),\n",
       " (('033', '094'), 0.08),\n",
       " (('034', '048'), 0.2),\n",
       " (('036', '051'), 0.12),\n",
       " (('036', '077'), 0.06),\n",
       " (('036', '091'), 0.16),\n",
       " (('037', '053'), 0.1),\n",
       " (('038', '061'), 0.08),\n",
       " (('038', '069'), 0.1),\n",
       " (('039', '080'), 0.04),\n",
       " (('040', '047'), 0.32),\n",
       " (('040', '049'), 0.4),\n",
       " (('042', '058'), 0.06),\n",
       " (('042', '066'), 0.04),\n",
       " (('043', '059'), 0.22),\n",
       " (('044', '076'), 0.24),\n",
       " (('047', '070'), 0.12),\n",
       " (('048', '057'), 0.22),\n",
       " (('049', '070'), 0.1),\n",
       " (('051', '068'), 0.18),\n",
       " (('051', '077'), 0.04),\n",
       " (('051', '091'), 0.06),\n",
       " (('052', '078'), 0.06),\n",
       " (('054', '079'), 0.2),\n",
       " (('056', '062'), 0.06),\n",
       " (('056', '081'), 0.06),\n",
       " (('056', '088'), 0.04),\n",
       " (('056', '093'), 0.06),\n",
       " (('062', '081'), 0.06),\n",
       " (('062', '088'), 0.08),\n",
       " (('063', '082'), 0.18),\n",
       " (('065', '085'), 0.16),\n",
       " (('067', '089'), 0.1),\n",
       " (('067', '101'), 0.1),\n",
       " (('068', '077'), 0.06),\n",
       " (('068', '091'), 0.06),\n",
       " (('072', '080'), 0.08),\n",
       " (('074', '097'), 0.04),\n",
       " (('078', '084'), 0.06),\n",
       " (('081', '093'), 0.1),\n",
       " (('083', '096'), 0.1),\n",
       " (('088', '093'), 0.06),\n",
       " (('089', '101'), 0.12),\n",
       " (('001', '097'), 0.04),\n",
       " (('003', '029'), 0.04),\n",
       " (('004', '058'), 0.04),\n",
       " (('006', '031'), 0.28),\n",
       " (('006', '081'), 0.06),\n",
       " (('006', '087'), 0.08),\n",
       " (('007', '054'), 0.06),\n",
       " (('007', '055'), 0.08),\n",
       " (('009', '027'), 0.04),\n",
       " (('009', '033'), 0.06),\n",
       " (('011', '022'), 0.04),\n",
       " (('011', '088'), 0.04),\n",
       " (('012', '054'), 0.04),\n",
       " (('014', '024'), 0.04),\n",
       " (('014', '040'), 0.26),\n",
       " (('016', '045'), 0.04),\n",
       " (('020', '054'), 0.04),\n",
       " (('021', '029'), 0.04),\n",
       " (('021', '099'), 0.04),\n",
       " (('022', '049'), 0.04),\n",
       " (('024', '040'), 0.04),\n",
       " (('025', '071'), 0.06),\n",
       " (('026', '092'), 0.04),\n",
       " (('029', '099'), 0.04),\n",
       " (('029', '101'), 0.04),\n",
       " (('030', '091'), 0.04),\n",
       " (('031', '081'), 0.04),\n",
       " (('031', '087'), 0.06),\n",
       " (('034', '064'), 0.04),\n",
       " (('035', '091'), 0.06),\n",
       " (('044', '063'), 0.04),\n",
       " (('044', '096'), 0.06),\n",
       " (('045', '086'), 0.04),\n",
       " (('045', '100'), 0.08),\n",
       " (('046', '048'), 0.04),\n",
       " (('046', '066'), 0.04),\n",
       " (('047', '061'), 0.08),\n",
       " (('047', '069'), 0.1),\n",
       " (('047', '093'), 0.1),\n",
       " (('048', '066'), 0.1),\n",
       " (('050', '053'), 0.06),\n",
       " (('052', '065'), 0.04),\n",
       " (('052', '072'), 0.04),\n",
       " (('056', '067'), 0.04),\n",
       " (('057', '082'), 0.22),\n",
       " (('060', '071'), 0.04),\n",
       " (('065', '072'), 0.04),\n",
       " (('065', '084'), 0.04),\n",
       " (('069', '076'), 0.06),\n",
       " (('070', '075'), 0.04),\n",
       " (('070', '089'), 0.06),\n",
       " (('072', '084'), 0.04),\n",
       " (('075', '089'), 0.14),\n",
       " (('081', '087'), 0.06),\n",
       " (('099', '101'), 0.06),\n",
       " (('001', '023'), 0.04),\n",
       " (('001', '040'), 0.04),\n",
       " (('002', '029'), 0.12),\n",
       " (('003', '018'), 0.06),\n",
       " (('004', '014'), 0.04),\n",
       " (('004', '027'), 0.04),\n",
       " (('005', '012'), 0.04),\n",
       " (('005', '020'), 0.04),\n",
       " (('005', '034'), 0.04),\n",
       " (('005', '041'), 0.06),\n",
       " (('005', '058'), 0.06),\n",
       " (('005', '072'), 0.04),\n",
       " (('005', '088'), 0.06),\n",
       " (('006', '039'), 0.18),\n",
       " (('007', '056'), 0.18),\n",
       " (('009', '091'), 0.06),\n",
       " (('012', '047'), 0.12),\n",
       " (('012', '049'), 0.08),\n",
       " (('012', '066'), 0.06),\n",
       " (('012', '072'), 0.08),\n",
       " (('012', '080'), 0.08),\n",
       " (('012', '088'), 0.14),\n",
       " (('014', '027'), 0.04),\n",
       " (('014', '055'), 0.06),\n",
       " (('017', '063'), 0.04),\n",
       " (('017', '095'), 0.04),\n",
       " (('019', '069'), 0.1),\n",
       " (('020', '047'), 0.12),\n",
       " (('020', '049'), 0.08),\n",
       " (('020', '066'), 0.06),\n",
       " (('020', '072'), 0.08),\n",
       " (('020', '080'), 0.08),\n",
       " (('020', '088'), 0.14),\n",
       " (('021', '059'), 0.04),\n",
       " (('022', '056'), 0.06),\n",
       " (('023', '038'), 0.28),\n",
       " (('023', '040'), 0.22),\n",
       " (('024', '034'), 0.04),\n",
       " (('024', '047'), 0.04),\n",
       " (('024', '049'), 0.08),\n",
       " (('024', '058'), 0.06),\n",
       " (('024', '066'), 0.1),\n",
       " (('024', '080'), 0.04),\n",
       " (('026', '075'), 0.08),\n",
       " (('026', '086'), 0.04),\n",
       " (('027', '055'), 0.06),\n",
       " (('029', '076'), 0.12),\n",
       " (('029', '081'), 0.06),\n",
       " (('030', '036'), 0.04),\n",
       " (('033', '067'), 0.04),\n",
       " (('034', '041'), 0.04),\n",
       " (('034', '047'), 0.1),\n",
       " (('034', '049'), 0.16),\n",
       " (('034', '058'), 0.06),\n",
       " (('034', '066'), 0.08),\n",
       " (('034', '072'), 0.06),\n",
       " (('034', '080'), 0.04),\n",
       " (('034', '088'), 0.06),\n",
       " (('035', '036'), 0.04),\n",
       " (('038', '057'), 0.04),\n",
       " (('041', '047'), 0.04),\n",
       " (('041', '049'), 0.04),\n",
       " (('041', '058'), 0.08),\n",
       " (('041', '066'), 0.08),\n",
       " (('041', '072'), 0.06),\n",
       " (('041', '080'), 0.04),\n",
       " (('042', '046'), 0.04),\n",
       " (('042', '097'), 0.06),\n",
       " (('043', '052'), 0.04),\n",
       " (('043', '084'), 0.04),\n",
       " (('044', '095'), 0.04),\n",
       " (('046', '097'), 0.04),\n",
       " (('047', '058'), 0.14),\n",
       " (('047', '066'), 0.1),\n",
       " (('047', '080'), 0.16),\n",
       " (('049', '058'), 0.16),\n",
       " (('049', '066'), 0.14),\n",
       " (('049', '080'), 0.06),\n",
       " (('050', '077'), 0.04),\n",
       " (('050', '089'), 0.06),\n",
       " (('051', '092'), 0.04),\n",
       " (('053', '092'), 0.14),\n",
       " (('054', '082'), 0.04),\n",
       " (('058', '072'), 0.16),\n",
       " (('058', '088'), 0.16),\n",
       " (('063', '095'), 0.12),\n",
       " (('064', '083'), 0.14),\n",
       " (('065', '071'), 0.06),\n",
       " (('066', '072'), 0.12),\n",
       " (('066', '080'), 0.04),\n",
       " (('066', '088'), 0.16),\n",
       " (('068', '070'), 0.04),\n",
       " (('072', '088'), 0.04),\n",
       " (('078', '087'), 0.06),\n",
       " (('080', '088'), 0.06),\n",
       " (('082', '099'), 0.04),\n",
       " (('085', '101'), 0.06),\n",
       " (('001', '025'), 0.04),\n",
       " (('001', '061'), 0.04),\n",
       " (('002', '028'), 0.08),\n",
       " (('002', '090'), 0.1),\n",
       " (('007', '025'), 0.04),\n",
       " (('007', '061'), 0.08),\n",
       " (('007', '065'), 0.04),\n",
       " (('007', '071'), 0.04),\n",
       " (('007', '073'), 0.04),\n",
       " (('007', '097'), 0.04),\n",
       " (('008', '021'), 0.1),\n",
       " (('008', '033'), 0.12),\n",
       " (('008', '094'), 0.14),\n",
       " (('010', '095'), 0.04),\n",
       " (('011', '015'), 0.04),\n",
       " (('011', '058'), 0.06),\n",
       " (('012', '099'), 0.04),\n",
       " (('014', '030'), 0.06),\n",
       " (('014', '035'), 0.04),\n",
       " (('014', '043'), 0.14),\n",
       " (('014', '050'), 0.06),\n",
       " (('014', '059'), 0.04),\n",
       " (('014', '069'), 0.04),\n",
       " (('014', '072'), 0.04),\n",
       " (('014', '075'), 0.08),\n",
       " (('014', '076'), 0.04),\n",
       " (('015', '058'), 0.06),\n",
       " (('016', '089'), 0.06),\n",
       " (('018', '063'), 0.06),\n",
       " (('020', '099'), 0.04),\n",
       " (('021', '082'), 0.04),\n",
       " (('022', '040'), 0.08),\n",
       " (('022', '057'), 0.18),\n",
       " (('022', '068'), 0.04),\n",
       " (('022', '081'), 0.06),\n",
       " (('024', '087'), 0.04),\n",
       " (('025', '061'), 0.04),\n",
       " (('025', '065'), 0.04),\n",
       " (('025', '073'), 0.16),\n",
       " (('026', '067'), 0.08),\n",
       " (('027', '101'), 0.38),\n",
       " (('030', '043'), 0.06),\n",
       " (('030', '050'), 0.06),\n",
       " (('030', '059'), 0.12),\n",
       " (('030', '069'), 0.06),\n",
       " (('030', '072'), 0.04),\n",
       " (('030', '075'), 0.08),\n",
       " (('030', '076'), 0.04),\n",
       " (('033', '082'), 0.2),\n",
       " (('035', '050'), 0.04),\n",
       " (('035', '059'), 0.08),\n",
       " (('035', '069'), 0.08),\n",
       " (('035', '072'), 0.06),\n",
       " (('035', '075'), 0.06),\n",
       " (('038', '086'), 0.08),\n",
       " (('040', '068'), 0.04),\n",
       " (('040', '079'), 0.04),\n",
       " (('040', '081'), 0.04),\n",
       " (('043', '050'), 0.1),\n",
       " (('043', '069'), 0.04),\n",
       " (('043', '075'), 0.18),\n",
       " (('043', '076'), 0.06),\n",
       " (('047', '048'), 0.28),\n",
       " (('047', '062'), 0.04),\n",
       " (('048', '049'), 0.36),\n",
       " (('048', '051'), 0.06),\n",
       " (('048', '088'), 0.04),\n",
       " (('049', '062'), 0.04),\n",
       " (('050', '072'), 0.06),\n",
       " (('050', '075'), 0.1),\n",
       " (('050', '076'), 0.06),\n",
       " (('051', '080'), 0.04),\n",
       " (('053', '098'), 0.04),\n",
       " (('056', '063'), 0.04),\n",
       " (('057', '068'), 0.04),\n",
       " (('057', '079'), 0.06),\n",
       " (('059', '075'), 0.14),\n",
       " (('059', '076'), 0.06),\n",
       " (('061', '071'), 0.08),\n",
       " (('062', '080'), 0.04),\n",
       " (('065', '073'), 0.06),\n",
       " (('065', '097'), 0.26),\n",
       " (('066', '092'), 0.04),\n",
       " (('068', '081'), 0.04),\n",
       " (('069', '075'), 0.04),\n",
       " (('071', '073'), 0.06),\n",
       " (('071', '097'), 0.12),\n",
       " (('072', '075'), 0.04),\n",
       " (('072', '076'), 0.04),\n",
       " (('073', '097'), 0.06),\n",
       " (('077', '078'), 0.06),\n",
       " (('003', '097'), 0.06),\n",
       " (('004', '060'), 0.04),\n",
       " (('004', '064'), 0.04),\n",
       " (('004', '074'), 0.06),\n",
       " (('005', '082'), 0.04),\n",
       " (('006', '055'), 0.16),\n",
       " (('007', '072'), 0.04),\n",
       " (('009', '059'), 0.06),\n",
       " (('009', '074'), 0.04),\n",
       " (('010', '052'), 0.08),\n",
       " (('010', '084'), 0.08),\n",
       " (('010', '090'), 0.06),\n",
       " (('011', '065'), 0.06),\n",
       " (('012', '061'), 0.06),\n",
       " (('013', '035'), 0.06),\n",
       " (('014', '019'), 0.04),\n",
       " (('015', '053'), 0.06),\n",
       " (('017', '025'), 0.04),\n",
       " (('017', '042'), 0.08),\n",
       " (('017', '045'), 0.18),\n",
       " (('017', '050'), 0.04),\n",
       " (('019', '040'), 0.04),\n",
       " (('019', '043'), 0.04),\n",
       " (('019', '070'), 0.06),\n",
       " (('020', '061'), 0.06),\n",
       " (('023', '047'), 0.34),\n",
       " (('023', '049'), 0.2),\n",
       " (('023', '092'), 0.04),\n",
       " (('024', '033'), 0.04),\n",
       " (('024', '081'), 0.04),\n",
       " (('025', '050'), 0.04),\n",
       " (('027', '031'), 0.04),\n",
       " (('031', '055'), 0.22),\n",
       " (('033', '081'), 0.06),\n",
       " (('034', '078'), 0.04),\n",
       " (('036', '063'), 0.08),\n",
       " (('036', '067'), 0.04),\n",
       " (('037', '085'), 0.04),\n",
       " (('038', '062'), 0.04),\n",
       " (('038', '071'), 0.04),\n",
       " (('039', '088'), 0.04),\n",
       " (('040', '043'), 0.08),\n",
       " (('042', '045'), 0.04),\n",
       " (('043', '070'), 0.04),\n",
       " (('043', '101'), 0.1),\n",
       " (('044', '087'), 0.04),\n",
       " (('045', '050'), 0.04),\n",
       " (('046', '054'), 0.06),\n",
       " (('047', '073'), 0.04),\n",
       " (('047', '092'), 0.04),\n",
       " (('047', '099'), 0.04),\n",
       " (('048', '073'), 0.06),\n",
       " (('048', '092'), 0.04),\n",
       " (('048', '096'), 0.04),\n",
       " (('048', '099'), 0.04),\n",
       " (('049', '073'), 0.08),\n",
       " (('049', '092'), 0.06),\n",
       " (('049', '099'), 0.04),\n",
       " (('051', '089'), 0.04),\n",
       " (('052', '056'), 0.04),\n",
       " (('052', '090'), 0.04),\n",
       " (('056', '084'), 0.04),\n",
       " (('059', '074'), 0.06),\n",
       " (('060', '064'), 0.06),\n",
       " (('060', '074'), 0.04),\n",
       " (('062', '071'), 0.04),\n",
       " (('064', '074'), 0.04),\n",
       " (('073', '099'), 0.16),\n",
       " (('076', '098'), 0.04),\n",
       " (('077', '083'), 0.04),\n",
       " (('084', '090'), 0.04),\n",
       " (('087', '093'), 0.06),\n",
       " (('094', '095'), 0.04),\n",
       " (('002', '053'), 0.04),\n",
       " (('002', '065'), 0.04),\n",
       " (('004', '025'), 0.04),\n",
       " (('004', '073'), 0.04),\n",
       " (('005', '013'), 0.04),\n",
       " (('007', '021'), 0.1),\n",
       " (('007', '030'), 0.06),\n",
       " (('007', '032'), 0.18),\n",
       " (('007', '035'), 0.04),\n",
       " (('007', '081'), 0.06),\n",
       " (('008', '017'), 0.04),\n",
       " (('009', '015'), 0.04),\n",
       " (('009', '070'), 0.24),\n",
       " (('009', '095'), 0.08),\n",
       " (('010', '094'), 0.06),\n",
       " (('011', '072'), 0.1),\n",
       " (('011', '086'), 0.22),\n",
       " (('014', '060'), 0.08),\n",
       " (('014', '091'), 0.04),\n",
       " (('015', '095'), 0.04),\n",
       " (('016', '033'), 0.04),\n",
       " (('016', '064'), 0.04),\n",
       " (('016', '076'), 0.3),\n",
       " (('019', '088'), 0.04),\n",
       " (('021', '035'), 0.04),\n",
       " (('021', '061'), 0.06),\n",
       " (('022', '101'), 0.04),\n",
       " (('023', '058'), 0.1),\n",
       " (('024', '074'), 0.06),\n",
       " (('025', '029'), 0.1),\n",
       " (('026', '083'), 0.06),\n",
       " (('026', '087'), 0.06),\n",
       " (('029', '071'), 0.04),\n",
       " (('029', '073'), 0.06),\n",
       " (('030', '061'), 0.08),\n",
       " (('030', '081'), 0.04),\n",
       " (('032', '061'), 0.06),\n",
       " (('033', '064'), 0.04),\n",
       " (('033', '076'), 0.04),\n",
       " (('034', '096'), 0.04),\n",
       " (('035', '061'), 0.04),\n",
       " (('035', '081'), 0.04),\n",
       " (('036', '100'), 0.04),\n",
       " (('037', '066'), 0.04),\n",
       " (('038', '047'), 0.12),\n",
       " (('038', '049'), 0.04),\n",
       " (('038', '058'), 0.14),\n",
       " (('038', '092'), 0.06),\n",
       " (('045', '078'), 0.12),\n",
       " (('055', '079'), 0.06),\n",
       " (('055', '090'), 0.04),\n",
       " (('057', '095'), 0.06),\n",
       " (('058', '092'), 0.04),\n",
       " (('059', '068'), 0.12),\n",
       " (('060', '078'), 0.1),\n",
       " (('061', '081'), 0.06),\n",
       " (('062', '092'), 0.08),\n",
       " (('070', '095'), 0.12),\n",
       " (('072', '086'), 0.12),\n",
       " (('072', '097'), 0.04),\n",
       " (('078', '091'), 0.06),\n",
       " (('086', '097'), 0.12),\n",
       " (('001', '044'), 0.14),\n",
       " (('001', '059'), 0.06),\n",
       " (('001', '090'), 0.12),\n",
       " (('003', '052'), 0.08),\n",
       " (('003', '084'), 0.08),\n",
       " (('006', '033'), 0.04),\n",
       " (('007', '053'), 0.04),\n",
       " (('008', '088'), 0.04),\n",
       " (('011', '071'), 0.04),\n",
       " (('012', '017'), 0.06),\n",
       " (('012', '030'), 0.08),\n",
       " (('012', '035'), 0.04),\n",
       " (('012', '051'), 0.08),\n",
       " (('013', '099'), 0.18),\n",
       " (('014', '066'), 0.12),\n",
       " (('016', '024'), 0.04),\n",
       " (('017', '020'), 0.06),\n",
       " (('017', '051'), 0.04),\n",
       " (('020', '030'), 0.08),\n",
       " (('020', '035'), 0.04),\n",
       " (('020', '051'), 0.08),\n",
       " (('021', '026'), 0.04),\n",
       " (('022', '025'), 0.06),\n",
       " (('022', '063'), 0.14),\n",
       " (('022', '094'), 0.12),\n",
       " (('024', '076'), 0.04),\n",
       " (('025', '036'), 0.04),\n",
       " (('025', '081'), 0.04),\n",
       " (('027', '067'), 0.1),\n",
       " (('028', '044'), 0.06),\n",
       " (('030', '068'), 0.06),\n",
       " (('031', '085'), 0.06),\n",
       " (('033', '042'), 0.04),\n",
       " (('034', '040'), 0.22),\n",
       " (('035', '068'), 0.04),\n",
       " (('036', '081'), 0.04),\n",
       " (('037', '078'), 0.18),\n",
       " (('040', '048'), 0.3),\n",
       " (('040', '089'), 0.06),\n",
       " (('044', '059'), 0.1),\n",
       " (('044', '090'), 0.06),\n",
       " (('045', '052'), 0.1),\n",
       " (('045', '084'), 0.1),\n",
       " (('046', '073'), 0.04),\n",
       " (('049', '089'), 0.06),\n",
       " (('052', '091'), 0.12),\n",
       " (('055', '085'), 0.04),\n",
       " (('060', '066'), 0.04),\n",
       " (('063', '094'), 0.1),\n",
       " (('065', '074'), 0.06),\n",
       " (('070', '096'), 0.04),\n",
       " (('075', '100'), 0.06),\n",
       " (('081', '094'), 0.04),\n",
       " (('084', '091'), 0.12),\n",
       " (('087', '098'), 0.08),\n",
       " (('092', '100'), 0.06),\n",
       " (('001', '030'), 0.04),\n",
       " (('001', '035'), 0.04),\n",
       " (('001', '051'), 0.08),\n",
       " (('002', '055'), 0.04),\n",
       " (('004', '096'), 0.04),\n",
       " (('005', '014'), 0.04),\n",
       " (('006', '046'), 0.08),\n",
       " (('007', '098'), 0.06),\n",
       " (('011', '031'), 0.06),\n",
       " (('012', '062'), 0.06),\n",
       " (('016', '062'), 0.08),\n",
       " (('017', '023'), 0.06),\n",
       " (('017', '033'), 0.1),\n",
       " (('017', '040'), 0.04),\n",
       " (('017', '047'), 0.04),\n",
       " (('017', '048'), 0.04),\n",
       " (('017', '049'), 0.04),\n",
       " (('017', '070'), 0.04),\n",
       " (('018', '064'), 0.12),\n",
       " (('018', '083'), 0.06),\n",
       " (('019', '038'), 0.04),\n",
       " (('019', '053'), 0.08),\n",
       " (('020', '062'), 0.06),\n",
       " (('021', '074'), 0.04),\n",
       " (('022', '060'), 0.04),\n",
       " (('023', '033'), 0.06),\n",
       " (('023', '070'), 0.08),\n",
       " (('025', '034'), 0.04),\n",
       " (('026', '079'), 0.06),\n",
       " (('026', '096'), 0.06),\n",
       " (('028', '045'), 0.04),\n",
       " (('030', '044'), 0.08),\n",
       " (('032', '098'), 0.08),\n",
       " (('033', '047'), 0.06),\n",
       " (('033', '048'), 0.08),\n",
       " (('033', '049'), 0.06),\n",
       " (('035', '044'), 0.08),\n",
       " (('036', '041'), 0.04),\n",
       " (('038', '072'), 0.12),\n",
       " (('038', '078'), 0.04),\n",
       " (('039', '086'), 0.04),\n",
       " (('041', '099'), 0.06),\n",
       " (('042', '081'), 0.04),\n",
       " (('042', '088'), 0.06),\n",
       " (('044', '051'), 0.16),\n",
       " (('048', '070'), 0.14),\n",
       " (('050', '068'), 0.2),\n",
       " (('051', '059'), 0.12),\n",
       " (('053', '078'), 0.18),\n",
       " (('056', '098'), 0.06),\n",
       " (('066', '073'), 0.06),\n",
       " (('067', '100'), 0.04),\n",
       " (('079', '096'), 0.04),\n",
       " (('003', '017'), 0.14),\n",
       " (('003', '033'), 0.1),\n",
       " (('003', '086'), 0.04),\n",
       " (('005', '083'), 0.04),\n",
       " (('006', '011'), 0.04),\n",
       " (('007', '014'), 0.04),\n",
       " (('007', '088'), 0.04),\n",
       " (('008', '032'), 0.06),\n",
       " (('008', '081'), 0.04),\n",
       " (('012', '040'), 0.08),\n",
       " (('012', '048'), 0.06),\n",
       " (('012', '057'), 0.04),\n",
       " (('012', '070'), 0.04),\n",
       " (('012', '082'), 0.04),\n",
       " (('013', '042'), 0.14),\n",
       " (('014', '025'), 0.06),\n",
       " (('014', '088'), 0.04),\n",
       " (('016', '069'), 0.04),\n",
       " (('017', '037'), 0.14),\n",
       " (('017', '091'), 0.04),\n",
       " (('018', '046'), 0.14),\n",
       " (('019', '051'), 0.08),\n",
       " (('020', '040'), 0.08),\n",
       " (('020', '048'), 0.06),\n",
       " (('020', '057'), 0.04),\n",
       " (('020', '070'), 0.04),\n",
       " (('020', '082'), 0.04),\n",
       " (('022', '064'), 0.04),\n",
       " (('023', '054'), 0.1),\n",
       " (('023', '093'), 0.08),\n",
       " (('025', '088'), 0.06),\n",
       " (('026', '043'), 0.18),\n",
       " (('026', '066'), 0.04),\n",
       " (('026', '074'), 0.06),\n",
       " (('030', '060'), 0.1),\n",
       " (('033', '037'), 0.04),\n",
       " (('033', '045'), 0.04),\n",
       " (('033', '086'), 0.06),\n",
       " (('033', '091'), 0.04),\n",
       " (('035', '060'), 0.08),\n",
       " (('036', '076'), 0.08),\n",
       " (('037', '086'), 0.04),\n",
       " (('038', '080'), 0.08),\n",
       " (('040', '082'), 0.12),\n",
       " (('043', '066'), 0.06),\n",
       " (('043', '074'), 0.04),\n",
       " (('043', '100'), 0.16),\n",
       " (('044', '068'), 0.14),\n",
       " (('047', '057'), 0.12),\n",
       " (('047', '082'), 0.1),\n",
       " (('048', '082'), 0.16),\n",
       " (('049', '057'), 0.12),\n",
       " (('049', '082'), 0.12),\n",
       " (('058', '061'), 0.04),\n",
       " (('059', '066'), 0.04),\n",
       " (('063', '079'), 0.04),\n",
       " (('065', '094'), 0.04),\n",
       " (('066', '074'), 0.12),\n",
       " (('066', '100'), 0.06),\n",
       " (('070', '082'), 0.26),\n",
       " (('074', '100'), 0.06),\n",
       " (('079', '095'), 0.04),\n",
       " (('085', '094'), 0.04),\n",
       " (('085', '097'), 0.12),\n",
       " (('088', '098'), 0.04),\n",
       " (('094', '097'), 0.04),\n",
       " (('005', '069'), 0.04),\n",
       " (('006', '061'), 0.04),\n",
       " (('008', '040'), 0.04),\n",
       " (('008', '042'), 0.04),\n",
       " (('008', '089'), 0.04),\n",
       " (('009', '063'), 0.18),\n",
       " (('011', '092'), 0.04),\n",
       " (('012', '069'), 0.08),\n",
       " (('014', '038'), 0.08),\n",
       " (('016', '030'), 0.1),\n",
       " (('016', '035'), 0.06),\n",
       " (('016', '054'), 0.04),\n",
       " (('017', '029'), 0.06),\n",
       " (('017', '087'), 0.04),\n",
       " (('019', '021'), 0.06),\n",
       " (('020', '069'), 0.08),\n",
       " (('022', '070'), 0.16),\n",
       " (('022', '082'), 0.04),\n",
       " (('023', '089'), 0.08),\n",
       " (('025', '092'), 0.04),\n",
       " (('027', '075'), 0.14),\n",
       " (('029', '087'), 0.06),\n",
       " (('030', '054'), 0.08),\n",
       " (('031', '061'), 0.04),\n",
       " (('031', '093'), 0.04),\n",
       " (('032', '039'), 0.04),\n",
       " (('034', '063'), 0.06),\n",
       " (('035', '054'), 0.04),\n",
       " (('038', '098'), 0.08),\n",
       " (('041', '067'), 0.04),\n",
       " (('043', '099'), 0.04),\n",
       " (('044', '071'), 0.06),\n",
       " (('051', '079'), 0.06),\n",
       " (('052', '086'), 0.04),\n",
       " (('055', '061'), 0.1),\n",
       " (('055', '093'), 0.14),\n",
       " (('058', '069'), 0.06),\n",
       " (('059', '073'), 0.04),\n",
       " (('062', '078'), 0.06),\n",
       " (('064', '068'), 0.04),\n",
       " (('066', '098'), 0.08),\n",
       " (('069', '088'), 0.04),\n",
       " (('075', '101'), 0.1),\n",
       " (('080', '100'), 0.04),\n",
       " (('084', '086'), 0.04),\n",
       " (('086', '090'), 0.04),\n",
       " (('002', '014'), 0.04),\n",
       " (('003', '027'), 0.04),\n",
       " (('006', '007'), 0.06),\n",
       " (('008', '075'), 0.06),\n",
       " (('009', '030'), 0.04),\n",
       " (('011', '099'), 0.04),\n",
       " (('012', '077'), 0.04),\n",
       " (('012', '087'), 0.06),\n",
       " (('012', '093'), 0.06),\n",
       " (('014', '036'), 0.06),\n",
       " (('014', '051'), 0.04),\n",
       " (('014', '068'), 0.04),\n",
       " (('015', '054'), 0.04),\n",
       " (('015', '089'), 0.06),\n",
       " (('019', '060'), 0.04),\n",
       " (('020', '077'), 0.04),\n",
       " (('020', '087'), 0.06),\n",
       " (('020', '093'), 0.06),\n",
       " (('021', '046'), 0.06),\n",
       " (('023', '065'), 0.06),\n",
       " (('023', '085'), 0.04),\n",
       " (('025', '062'), 0.06),\n",
       " (('036', '040'), 0.06),\n",
       " (('038', '065'), 0.04),\n",
       " (('038', '085'), 0.06),\n",
       " (('039', '060'), 0.04),\n",
       " (('040', '051'), 0.06),\n",
       " (('043', '047'), 0.04),\n",
       " (('043', '049'), 0.04),\n",
       " (('048', '058'), 0.04),\n",
       " (('054', '089'), 0.1),\n",
       " (('055', '069'), 0.06),\n",
       " (('055', '077'), 0.04),\n",
       " (('055', '087'), 0.04),\n",
       " (('057', '058'), 0.06),\n",
       " (('057', '066'), 0.08),\n",
       " (('058', '067'), 0.06),\n",
       " (('059', '098'), 0.06),\n",
       " (('061', '077'), 0.04),\n",
       " (('063', '072'), 0.04),\n",
       " (('065', '086'), 0.08),\n",
       " (('069', '077'), 0.04),\n",
       " (('069', '087'), 0.06),\n",
       " (('071', '090'), 0.04),\n",
       " (('072', '091'), 0.04),\n",
       " (('072', '095'), 0.06),\n",
       " (('074', '098'), 0.06),\n",
       " (('076', '097'), 0.04),\n",
       " (('076', '099'), 0.04),\n",
       " (('077', '093'), 0.04),\n",
       " (('081', '083'), 0.04),\n",
       " (('081', '090'), 0.04),\n",
       " (('082', '089'), 0.08),\n",
       " (('085', '086'), 0.04),\n",
       " (('001', '019'), 0.04),\n",
       " (('001', '021'), 0.06),\n",
       " (('001', '031'), 0.08),\n",
       " (('004', '065'), 0.06),\n",
       " (('005', '023'), 0.06),\n",
       " (('005', '038'), 0.08),\n",
       " (('005', '054'), 0.04),\n",
       " (('005', '101'), 0.04),\n",
       " (('006', '047'), 0.06),\n",
       " (('006', '049'), 0.08),\n",
       " (('008', '065'), 0.04),\n",
       " (('008', '074'), 0.06),\n",
       " (('009', '082'), 0.14),\n",
       " (('013', '025'), 0.18),\n",
       " (('013', '046'), 0.06),\n",
       " (('013', '058'), 0.08),\n",
       " (('013', '066'), 0.08),\n",
       " (('013', '073'), 0.06),\n",
       " (('015', '064'), 0.04),\n",
       " (('016', '041'), 0.06),\n",
       " (('017', '080'), 0.06),\n",
       " (('018', '061'), 0.08),\n",
       " (('018', '069'), 0.08),\n",
       " (('019', '028'), 0.04),\n",
       " (('019', '085'), 0.04),\n",
       " (('021', '070'), 0.04),\n",
       " (('021', '085'), 0.06),\n",
       " (('023', '075'), 0.04),\n",
       " (('024', '036'), 0.04),\n",
       " (('027', '089'), 0.1),\n",
       " (('028', '040'), 0.08),\n",
       " (('028', '051'), 0.04),\n",
       " (('028', '085'), 0.06),\n",
       " (('030', '079'), 0.06),\n",
       " (('031', '051'), 0.06),\n",
       " (('033', '041'), 0.04),\n",
       " (('035', '086'), 0.04),\n",
       " (('038', '054'), 0.08),\n",
       " (('038', '075'), 0.04),\n",
       " (('038', '089'), 0.06),\n",
       " (('039', '083'), 0.04),\n",
       " (('040', '085'), 0.06),\n",
       " (('042', '073'), 0.14),\n",
       " (('044', '086'), 0.04),\n",
       " (('046', '058'), 0.04),\n",
       " (('053', '094'), 0.06),\n",
       " (('054', '078'), 0.04),\n",
       " (('057', '063'), 0.18),\n",
       " (('058', '073'), 0.06),\n",
       " (('058', '099'), 0.12),\n",
       " (('060', '087'), 0.04),\n",
       " (('061', '079'), 0.08),\n",
       " (('066', '099'), 0.04),\n",
       " (('069', '079'), 0.04),\n",
       " (('075', '078'), 0.06),\n",
       " (('078', '089'), 0.06),\n",
       " (('078', '101'), 0.04),\n",
       " (('001', '042'), 0.04),\n",
       " (('010', '065'), 0.08),\n",
       " (('010', '085'), 0.1),\n",
       " (('010', '097'), 0.14),\n",
       " (('013', '082'), 0.04),\n",
       " (('014', '087'), 0.06),\n",
       " (('016', '044'), 0.12),\n",
       " (('018', '099'), 0.04),\n",
       " (('019', '022'), 0.06),\n",
       " (('021', '069'), 0.04),\n",
       " (('021', '078'), 0.06),\n",
       " (('027', '085'), 0.04),\n",
       " (('029', '036'), 0.2),\n",
       " (('029', '091'), 0.08),\n",
       " (('038', '087'), 0.08),\n",
       " (('051', '074'), 0.04),\n",
       " (('055', '071'), 0.06),\n",
       " (('061', '078'), 0.04),\n",
       " (('062', '077'), 0.04),\n",
       " (('063', '070'), 0.18),\n",
       " (('068', '074'), 0.06),\n",
       " (('068', '076'), 0.08),\n",
       " (('069', '078'), 0.06),\n",
       " (('078', '093'), 0.04),\n",
       " (('079', '082'), 0.16),\n",
       " (('080', '098'), 0.04),\n",
       " ...]"
      ]
     },
     "execution_count": 334,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Similarity"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# 四、Top 10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 344,
   "metadata": {},
   "outputs": [],
   "source": [
    "Top_10 = sorted(Similarity,key = lambda x: x[1],reverse = True)[:10]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 345,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[(('012', '020'), 1.0),\n",
       " (('052', '084'), 1.0),\n",
       " (('047', '049'), 0.76),\n",
       " (('030', '035'), 0.58),\n",
       " (('045', '091'), 0.46),\n",
       " (('061', '069'), 0.4),\n",
       " (('040', '049'), 0.4),\n",
       " (('028', '090'), 0.38),\n",
       " (('027', '101'), 0.38),\n",
       " (('048', '049'), 0.36)]"
      ]
     },
     "execution_count": 345,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Top_10"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
